{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/lib/supabase/client.ts"],"sourcesContent":["\"use client\"\r\n\r\nimport { createBrowserClient } from \"@supabase/ssr\"\r\n\r\nexport function createClient() {\r\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\r\n  const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\r\n\r\n  // Return null if env vars are missing instead of throwing\r\n  if (!supabaseUrl || !supabaseAnonKey) {\r\n    console.warn(\"[v0] Supabase environment variables not configured\")\r\n    return null\r\n  }\r\n\r\n  return createBrowserClient(supabaseUrl, supabaseAnonKey)\r\n}\r\n"],"names":[],"mappings":";;;;AAKsB;AAHtB;AAAA;AAFA;;AAIO,SAAS;IACd,MAAM;IACN,MAAM;IAEN,0DAA0D;IAC1D;;IAKA,OAAO,IAAA,oMAAmB,EAAC,aAAa;AAC1C"}},
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\r\nimport { twMerge } from 'tailwind-merge'\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs))\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,yKAAO,EAAC,IAAA,gJAAI,EAAC;AACtB"}},
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\r\nimport { Slot } from '@radix-ui/react-slot'\r\nimport { cva, type VariantProps } from 'class-variance-authority'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nconst buttonVariants = cva(\r\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\r\n        destructive:\r\n          'bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\r\n        outline:\r\n          'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',\r\n        secondary:\r\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\r\n        ghost:\r\n          'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',\r\n        link: 'text-primary underline-offset-4 hover:underline',\r\n      },\r\n      size: {\r\n        default: 'h-9 px-4 py-2 has-[>svg]:px-3',\r\n        sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',\r\n        lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',\r\n        icon: 'size-9',\r\n        'icon-sm': 'size-8',\r\n        'icon-lg': 'size-10',\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: 'default',\r\n      size: 'default',\r\n    },\r\n  },\r\n)\r\n\r\nfunction Button({\r\n  className,\r\n  variant,\r\n  size,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<'button'> &\r\n  VariantProps<typeof buttonVariants> & {\r\n    asChild?: boolean\r\n  }) {\r\n  const Comp = asChild ? Slot : 'button'\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"button\"\r\n      className={cn(buttonVariants({ variant, size, className }))}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Button, buttonVariants }\r\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,0KAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,2KAAI,GAAG;IAE9B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf;KAnBS"}},
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/components/ui/input.tsx"],"sourcesContent":["import * as React from 'react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Input({ className, type, ...props }: React.ComponentProps<'input'>) {\r\n  return (\r\n    <input\r\n      type={type}\r\n      data-slot=\"input\"\r\n      className={cn(\r\n        'file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\r\n        'focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]',\r\n        'aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Input }\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAsC;IACzE,qBACE,6LAAC;QACC,MAAM;QACN,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,8bACA,iFACA,0GACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS"}},
    {"offset": {"line": 142, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/components/ui/card.tsx"],"sourcesContent":["import * as React from 'react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Card({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card\"\r\n      className={cn(\r\n        'bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardHeader({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-header\"\r\n      className={cn(\r\n        '@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardTitle({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-title\"\r\n      className={cn('leading-none font-semibold', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardDescription({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-description\"\r\n      className={cn('text-muted-foreground text-sm', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardAction({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-action\"\r\n      className={cn(\r\n        'col-start-2 row-span-2 row-start-1 self-start justify-self-end',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardContent({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-content\"\r\n      className={cn('px-6', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardFooter({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-footer\"\r\n      className={cn('flex items-center px-6 [.border-t]:pt-6', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  Card,\r\n  CardHeader,\r\n  CardFooter,\r\n  CardTitle,\r\n  CardAction,\r\n  CardDescription,\r\n  CardContent,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf;MARS"}},
    {"offset": {"line": 262, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/components/auth-form.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport type React from \"react\"\r\nimport { useState } from \"react\"\r\n// âœ… Re-introducing client-side imports for sign-in functionality\r\nimport { useRouter } from \"next/navigation\" \r\nimport { createClient } from \"@/lib/supabase/client\" \r\n\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\"\r\n\r\ninterface AuthFormProps {\r\n  onLoginSuccess: (userData: { email: string }) => void\r\n}\r\n\r\nexport function AuthForm({ onLoginSuccess }: AuthFormProps) {\r\n  const router = useRouter(); // Initialize router\r\n  const supabase = createClient(); // Initialize client-side Supabase client\r\n\r\n  const [isSignup, setIsSignup] = useState(false)\r\n  const [username, setUsername] = useState(\"\")\r\n  const [email, setEmail] = useState(\"\")\r\n  const [password, setPassword] = useState(\"\")\r\n  const [error, setError] = useState(\"\")\r\n  const [loading, setLoading] = useState(false)\r\n  \r\n  // isDev is defaulted to false for simplicity in this form\r\n  const isDev = false; \r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n    setError(\"\")\r\n    setLoading(true)\r\n\r\n    try {\r\n      if (isSignup) {\r\n        // --- UNIFIED SERVER-SIDE SIGNUP FLOW ---\r\n        \r\n        const response = await fetch(\"/api/auth/signup\", {\r\n          method: \"POST\",\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n          body: JSON.stringify({\r\n            username,\r\n            email,\r\n            password,\r\n            isDev,\r\n          }),\r\n        })\r\n        \r\n        const result = await response.json();\r\n\r\n        if (!response.ok) {\r\n          setError(result.error || \"Sign up failed due to generic server error.\")\r\n          return\r\n        }\r\n\r\n        setError(result.message) \r\n\r\n      } else {\r\n        if (!supabase) {\r\n          setError(\"Authentication client not initialized.\")\r\n          return\r\n        }\r\n\r\n        const { error: signInError } = await supabase.auth.signInWithPassword({\r\n          email,\r\n          password,\r\n        })\r\n\r\n        if (signInError) {\r\n          // Supabase errors are detailed (e.g., Invalid login credentials)\r\n          setError(signInError.message)\r\n          return\r\n        }\r\n        \r\n        // Successful sign-in: Refresh the page to update the session state\r\n        router.refresh()\r\n      }\r\n    } catch (err) {\r\n      // This catches network errors or unexpected code issues\r\n      setError(\"A network error or unexpected client error occurred.\")\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\r\n      <Card className=\"w-full max-w-md border-2 border-primary bg-card rounded-xl shadow-2xl\">\r\n        <CardHeader className=\"border-b-2 border-primary\">\r\n          <CardTitle className=\"text-3xl font-extrabold text-primary tracking-wider\">CRIMSON</CardTitle>\r\n          <CardDescription className=\"text-lg text-muted-foreground pt-1\">\r\n            {isSignup ? \"Create your new account\" : \"Sign in to continue\"}\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"pt-6\">\r\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n            {isSignup && (\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-2 text-foreground\">Username</label>\r\n                <Input\r\n                  type=\"text\"\r\n                  placeholder=\"Enter unique username\"\r\n                  value={username}\r\n                  onChange={(e) => setUsername(e.target.value)}\r\n                  className=\"border-primary focus:border-primary-500 bg-background\"\r\n                  required\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium mb-2 text-foreground\">Email</label>\r\n              <Input\r\n                type=\"email\"\r\n                placeholder=\"Enter email\"\r\n                value={email}\r\n                onChange={(e) => setEmail(e.target.value)}\r\n                required\r\n                className=\"border-primary focus:border-primary-500 bg-background\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium mb-2 text-foreground\">Password</label>\r\n              <Input\r\n                type=\"password\"\r\n                placeholder=\"Enter password\"\r\n                value={password}\r\n                onChange={(e) => setPassword(e.target.value)}\r\n                required\r\n                className=\"border-primary focus:border-primary-500 bg-background\"\r\n              />\r\n            </div>\r\n\r\n            {error && <div className=\"p-3 bg-red-900/10 border border-red-500 text-red-400 rounded-lg font-mono text-sm overflow-x-auto\">{error}</div>}\r\n\r\n            <Button\r\n              type=\"submit\"\r\n              disabled={loading}\r\n              className=\"w-full bg-primary text-primary-foreground hover:bg-primary/90 border-2 border-primary transition-all duration-300\"\r\n            >\r\n              {loading ? \"Processing...\" : isSignup ? \"Sign Up\" : \"Sign In\"}\r\n            </Button>\r\n          </form>\r\n\r\n          <div className=\"mt-8 text-center\">\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              {isSignup ? \"Already have an account?\" : \"Don't have an account?\"}\r\n            </p>\r\n            <button\r\n              onClick={() => {\r\n                setIsSignup(!isSignup)\r\n                setError(\"\")\r\n                setUsername(\"\")\r\n                setPassword(\"\")\r\n              }}\r\n              className=\"mt-2 text-primary font-semibold hover:underline\"\r\n            >\r\n              {isSignup ? \"Sign In\" : \"Sign Up\"}\r\n            </button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 553, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/components/game-detail-modal.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { X, ChevronDown, ChevronUp } from \"lucide-react\"\r\n\r\ninterface GameDetailModalProps {\r\n  gameId: number\r\n  onClose: () => void\r\n}\r\n\r\nexport function GameDetailModal({ gameId, onClose }: GameDetailModalProps) {\r\n  const [expandedSections, setExpandedSections] = useState({\r\n    overview: true,\r\n    characters: false,\r\n    maps: false,\r\n    mobs: false,\r\n    storyArcs: false,\r\n    contributors: false\r\n  })\r\n  const [formattedDate, setFormattedDate] = useState<string>(\"\")\r\n  const [gameData, setGameData] = useState<any>(null)\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState(false)\r\n\r\n  const toggleSection = (section: keyof typeof expandedSections) => {\r\n    setExpandedSections(prev => ({ ...prev, [section]: !prev[section] }))\r\n  }\r\n\r\n  useEffect(() => {\r\n    const fetchGameDetails = async () => {\r\n      setLoading(true)\r\n      setError(false)\r\n      try {\r\n        console.log(`Fetching game details for game ID: ${gameId}`)\r\n        const res = await fetch(`/api/games/${gameId}`)\r\n        if (!res.ok) throw new Error(\"Failed to fetch\")\r\n        const data = await res.json()\r\n        setGameData({\r\n          ...data,\r\n          characters: data.games_characters || [],\r\n          maps: data.maps || [],\r\n          mobs: data.mobs || [],\r\n          storyArcs: data.storyarcs || [],\r\n          contributors: data.games_contributors || [],\r\n        })\r\n      } catch (err) {\r\n        console.error(err)\r\n        setError(true)\r\n      } finally {\r\n        setLoading(false)\r\n      }\r\n    }\r\n\r\n    fetchGameDetails()\r\n  }, [gameId])\r\n\r\n  // a separate useEffect to handle client-side date formatting\r\n  useEffect(() => {\r\n    if (gameData && gameData.releasedate) {\r\n      // will only run on the client after hydration is complete\r\n      const dateStr = new Date(gameData.releasedate).toLocaleDateString();\r\n      setFormattedDate(dateStr);\r\n    }\r\n  }, [gameData]);\r\n\r\n  if (loading) return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n      <Card className=\"w-full max-w-2xl border-2 border-accent\">\r\n        <CardContent className=\"pt-6 text-center\">\r\n          <p className=\"text-muted-foreground\">Loading game details...</p>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  )\r\n\r\n  if (error || !gameData) return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n      <Card className=\"w-full max-w-xl border-2 border-red-500 bg-card\">\r\n        <CardHeader className=\"border-b-2 border-red-500 flex justify-between items-start\">\r\n          <CardTitle className=\"text-xl text-red-500\">Failed to load game</CardTitle>\r\n          <button onClick={onClose} className=\"p-1 hover:bg-red-500/20 rounded\">\r\n            <X size={24} className=\"text-red-500\" />\r\n          </button>\r\n        </CardHeader>\r\n        <CardContent className=\"pt-6 text-center\">\r\n          <p className=\"text-muted-foreground\">Could not fetch game details.</p>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  )\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto\">\r\n      <Card className=\"w-full max-w-2xl border-2 border-accent bg-card my-8 max-h-[90vh] flex flex-col\">\r\n        <CardHeader className=\"border-b-2 border-accent flex justify-between items-start flex-shrink-0\">\r\n          <div>\r\n            <CardTitle className=\"text-2xl text-primary\">{gameData.title}</CardTitle>\r\n            <CardDescription className=\"text-muted-foreground\">\r\n              Released: {formattedDate || new Date(gameData.releasedate).toISOString().split('T')[0]}\r\n            </CardDescription>\r\n          </div>\r\n          <button onClick={onClose} className=\"p-1 hover:bg-accent/20 rounded\">\r\n            <X size={24} className=\"text-accent\" />\r\n          </button>\r\n        </CardHeader>\r\n\r\n        <CardContent className=\"pt-6 space-y-4 overflow-y-auto flex-grow\">\r\n          {/* Overview */}\r\n          <div className=\"border-l-4 border-accent\">\r\n            <button\r\n              onClick={() => toggleSection(\"overview\")}\r\n              className=\"w-full flex items-center justify-between p-3 bg-primary/10 hover:bg-primary/20 rounded\"\r\n            >\r\n              <h3 className=\"font-bold text-primary text-lg\">Overview</h3>\r\n              {expandedSections.overview ? <ChevronUp size={20} /> : <ChevronDown size={20} />}\r\n            </button>\r\n            {expandedSections.overview && (\r\n              <div className=\"p-4 space-y-3\">\r\n                {gameData.gamelogourl && (\r\n                  <div className=\"w-full bg-muted rounded overflow-hidden\">\r\n                    <img src={gameData.gamelogourl} alt=\"Game Logo\" className=\"w-full h-full object-cover\" />\r\n                  </div>\r\n                )}\r\n                <div>\r\n                  <p className=\"text-sm font-semibold text-muted-foreground\">Plot Summary</p>\r\n                  <p className=\"text-foreground\">{gameData.plotsummary || \"No description available\"}</p>\r\n                </div>\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <p className=\"text-sm font-semibold text-muted-foreground\">Multiplayer</p>\r\n                    <p className=\"text-foreground\">{gameData.multiplayersupport ? \"Yes\" : \"Single Player\"}</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Characters */}\r\n          <Section title=\"Characters\" items={gameData.characters} expanded={expandedSections.characters} toggle={() => toggleSection(\"characters\")} renderItem={(bridgeItem: any) => {\r\n            const char = bridgeItem.ingamecharacters || {};\r\n            return (\r\n              <div key={char.characterid} className=\"p-2 bg-muted rounded\">\r\n                <p className=\"font-semibold text-foreground\">{char.charactername}</p>\r\n                <p className=\"text-sm text-muted-foreground\">{char.backstory}</p>\r\n              </div>\r\n            );\r\n          }} />\r\n\r\n          {/* Maps */}\r\n          <Section title=\"Maps\" items={gameData.maps} expanded={expandedSections.maps} toggle={() => toggleSection(\"maps\")} renderItem={(map: any) => (\r\n            <div key={map.mapid} className=\"p-2 bg-muted rounded\">\r\n              <p className=\"font-semibold text-foreground\">{map.mapname}{map.floorname && ` (${map.floorname})`}</p>\r\n              <p className=\"text-sm text-muted-foreground\">{map.description}</p>\r\n            </div>\r\n          )} />\r\n\r\n          {/* Mobs */}\r\n          <Section title=\"Enemies\" items={gameData.mobs} expanded={expandedSections.mobs} toggle={() => toggleSection(\"mobs\")} renderItem={(mob: any) => (\r\n            <div key={mob.mobid} className=\"p-2 bg-muted rounded\">\r\n              <div className=\"flex justify-between items-start\">\r\n                <div>\r\n                  <p className=\"font-semibold text-foreground\">{mob.mobname}</p>\r\n                  <p className=\"text-sm text-muted-foreground\">{mob.description}</p>\r\n                </div>\r\n                <span className=\"text-xs bg-accent text-accent-foreground px-2 py-1 rounded\">{mob.mobtype}</span>\r\n              </div>\r\n              {mob.weakness && <p className=\"text-xs mt-1 text-muted-foreground\">Weakness: <span className=\"font-semibold\">{mob.weakness}</span></p>}\r\n            </div>\r\n          )} />\r\n\r\n          {/* Story Arcs */}\r\n          <Section title=\"Story Arcs\" items={gameData.storyArcs} expanded={expandedSections.storyArcs} toggle={() => toggleSection(\"storyArcs\")} renderItem={(arc: any) => (\r\n            <div key={arc.storyarcid} className=\"p-2 bg-muted rounded\">\r\n              <div className=\"flex justify-between items-start\">\r\n                <div>\r\n                  <p className=\"font-semibold text-foreground\">{arc.arctitle}</p>\r\n                  <p className=\"text-sm text-muted-foreground\">{arc.summary}</p>\r\n                </div>\r\n                {arc.ismainarc && <span className=\"text-xs bg-primary text-primary-foreground px-2 py-1 rounded\">Main Arc</span>}\r\n              </div>\r\n            </div>\r\n          )} />\r\n\r\n          {/* Contributors */}\r\n          <Section title=\"Contributors\" items={gameData.contributors} expanded={expandedSections.contributors} toggle={() => toggleSection(\"contributors\")} renderItem={(bridgeItem: any) => {\r\n            const contrib = bridgeItem.contributors || {};\r\n            return (\r\n              <div key={contrib.contributorid} className=\"p-2 bg-muted rounded\">\r\n                <p className=\"font-semibold text-foreground\">{contrib.contributorname}</p>\r\n                <div className=\"flex gap-2 text-xs mt-1\">\r\n                  <span className=\"text-muted-foreground\">{contrib.rolename}</span>\r\n                  {contrib.specialization && <>\r\n                    <span className=\"text-muted-foreground\">{contrib.specialization}</span>\r\n                  </>}\r\n                </div>\r\n              </div>\r\n            );\r\n          }} />\r\n\r\n          <Button\r\n            onClick={onClose}\r\n            className=\"w-full bg-accent text-accent-foreground hover:bg-accent/90 border-2 border-accent\"\r\n          >\r\n            Close\r\n          </Button>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  )\r\n}\r\n\r\n// reusable section component\r\nfunction Section({ title, items, expanded, toggle, renderItem }: any) {\r\n  return (\r\n    <div className=\"border-l-4 border-accent\">\r\n      <button onClick={toggle} className=\"w-full flex items-center justify-between p-3 bg-primary/10 hover:bg-primary/20 rounded\">\r\n        <h3 className=\"font-bold text-primary text-lg\">{title} ({items?.length || 0})</h3>\r\n        {expanded ? <ChevronUp size={20} /> : <ChevronDown size={20} />}\r\n      </button>\r\n      {expanded && (\r\n        <div className=\"p-4 space-y-2\">\r\n          {items && items.length > 0 ? items.map(renderItem) : <p className=\"text-muted-foreground\">No {title.toLowerCase()} found</p>}\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1284, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/components/games-gallery.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState } from \"react\"\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { RefreshCw } from \"lucide-react\"\r\nimport { GameDetailModal } from \"./game-detail-modal\"\r\n\r\ninterface GamesGalleryProps {\r\n  games: any[]\r\n  loading: boolean\r\n  onRefresh: () => void\r\n}\r\n\r\nexport function GamesGallery({ games, loading, onRefresh }: GamesGalleryProps) {\r\n  const [selectedGameId, setSelectedGameId] = useState<number | null>(null)\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-96\">\r\n        <p className=\"text-lg text-muted-foreground\">Loading games...</p>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div className=\"space-y-6\">\r\n        <div className=\"flex justify-between items-center\">\r\n          <h1 className=\"text-3xl font-bold text-primary\">Game Database</h1>\r\n          <Button onClick={onRefresh} className=\"bg-accent text-accent-foreground hover:bg-accent/90\">\r\n            <RefreshCw size={20} className=\"mr-2\" />\r\n            Refresh\r\n          </Button>\r\n        </div>\r\n\r\n        {games.length === 0 ? (\r\n          <Card className=\"border-2 border-primary bg-card\">\r\n            <CardContent className=\"pt-6 text-center\">\r\n              <p className=\"text-muted-foreground\">No games found. Add one to get started!</p>\r\n            </CardContent>\r\n          </Card>\r\n        ) : (\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n            {games.map((game) => (\r\n              <Card\r\n                key={game.gameid}\r\n                className=\"border-2 border-primary hover:border-accent transition-colors bg-card cursor-pointer\"\r\n                onClick={() => setSelectedGameId(game.gameid)}\r\n              >\r\n                {game.gamecoverurl && (\r\n                  <div className=\"w-full bg-muted overflow-hidden rounded-t relative\">\r\n                    <div className=\"pb-[133.33%] leading-none\"></div>\r\n                    <img\r\n                      src={game.gamecoverurl || \"/placeholder.svg\"}\r\n                      alt={game.title}\r\n                      className=\"object-cover absolute inset-0 rounded-t\"\r\n                    />\r\n                  </div>\r\n                )}\r\n\r\n                <CardHeader>\r\n                  <CardTitle className=\"text-primary\">{game.title}</CardTitle>\r\n                  <CardDescription className=\"text-muted-foreground\">\r\n                    Released: {new Date(game.releasedate).getFullYear()}\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-2\">\r\n                  <p className=\"text-sm\">{game.plotsummary}</p>\r\n                  <div className=\"flex gap-2 flex-wrap\">\r\n                    <span className=\"text-xs bg-primary text-primary-foreground px-2 py-1 rounded\">\r\n                      {game.multiplayersupport ? \"Multiplayer\" : \"Single Player\"}\r\n                    </span>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {selectedGameId && (\r\n        <GameDetailModal\r\n          gameId={selectedGameId}\r\n          onClose={() => setSelectedGameId(null)}\r\n        />\r\n      )}\r\n    </>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;;;AANA;;;;;;AAcO,SAAS,aAAa,EAAE,KAAK,EAAE,OAAO,EAAE,SAAS,EAAqB;;IAC3E,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAgB;IAEpE,IAAI,SAAS;QACX,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAE,WAAU;0BAAgC;;;;;;;;;;;IAGnD;IAEA,qBACE;;0BACE,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAG,WAAU;0CAAkC;;;;;;0CAChD,6LAAC,wIAAM;gCAAC,SAAS;gCAAW,WAAU;;kDACpC,6LAAC,gOAAS;wCAAC,MAAM;wCAAI,WAAU;;;;;;oCAAS;;;;;;;;;;;;;oBAK3C,MAAM,MAAM,KAAK,kBAChB,6LAAC,oIAAI;wBAAC,WAAU;kCACd,cAAA,6LAAC,2IAAW;4BAAC,WAAU;sCACrB,cAAA,6LAAC;gCAAE,WAAU;0CAAwB;;;;;;;;;;;;;;;6CAIzC,6LAAC;wBAAI,WAAU;kCACZ,MAAM,GAAG,CAAC,CAAC,qBACV,6LAAC,oIAAI;gCAEH,WAAU;gCACV,SAAS,IAAM,kBAAkB,KAAK,MAAM;;oCAE3C,KAAK,YAAY,kBAChB,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAI,WAAU;;;;;;0DACf,6LAAC;gDACC,KAAK,KAAK,YAAY,IAAI;gDAC1B,KAAK,KAAK,KAAK;gDACf,WAAU;;;;;;;;;;;;kDAKhB,6LAAC,0IAAU;;0DACT,6LAAC,yIAAS;gDAAC,WAAU;0DAAgB,KAAK,KAAK;;;;;;0DAC/C,6LAAC,+IAAe;gDAAC,WAAU;;oDAAwB;oDACtC,IAAI,KAAK,KAAK,WAAW,EAAE,WAAW;;;;;;;;;;;;;kDAGrD,6LAAC,2IAAW;wCAAC,WAAU;;0DACrB,6LAAC;gDAAE,WAAU;0DAAW,KAAK,WAAW;;;;;;0DACxC,6LAAC;gDAAI,WAAU;0DACb,cAAA,6LAAC;oDAAK,WAAU;8DACb,KAAK,kBAAkB,GAAG,gBAAgB;;;;;;;;;;;;;;;;;;+BAzB5C,KAAK,MAAM;;;;;;;;;;;;;;;;YAmCzB,gCACC,6LAAC,4JAAe;gBACd,QAAQ;gBACR,SAAS,IAAM,kBAAkB;;;;;;;;AAK3C;GA3EgB;KAAA"}},
    {"offset": {"line": 1513, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/components/ui/tabs.tsx"],"sourcesContent":["'use client'\r\n\r\nimport * as React from 'react'\r\nimport * as TabsPrimitive from '@radix-ui/react-tabs'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Tabs({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof TabsPrimitive.Root>) {\r\n  return (\r\n    <TabsPrimitive.Root\r\n      data-slot=\"tabs\"\r\n      className={cn('flex flex-col gap-2', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction TabsList({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof TabsPrimitive.List>) {\r\n  return (\r\n    <TabsPrimitive.List\r\n      data-slot=\"tabs-list\"\r\n      className={cn(\r\n        'bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction TabsTrigger({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {\r\n  return (\r\n    <TabsPrimitive.Trigger\r\n      data-slot=\"tabs-trigger\"\r\n      className={cn(\r\n        \"data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction TabsContent({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof TabsPrimitive.Content>) {\r\n  return (\r\n    <TabsPrimitive.Content\r\n      data-slot=\"tabs-content\"\r\n      className={cn('flex-1 outline-none', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\r\n"],"names":[],"mappings":";;;;;;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,KAAK,EACZ,SAAS,EACT,GAAG,OAC6C;IAChD,qBACE,6LAAC,2KAAkB;QACjB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,uBAAuB;QACpC,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,SAAS,EAChB,SAAS,EACT,GAAG,OAC6C;IAChD,qBACE,6LAAC,2KAAkB;QACjB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,uGACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6LAAC,8KAAqB;QACpB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,mqBACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6LAAC,8KAAqB;QACpB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,uBAAuB;QACpC,GAAG,KAAK;;;;;;AAGf;MAXS"}},
    {"offset": {"line": 1591, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/components/character-form.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport type React from \"react\"\r\n\r\nimport { useState } from \"react\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Plus } from \"lucide-react\"\r\n\r\nexport function CharacterForm() {\r\n  const [characters, setCharacters] = useState<any[]>([])\r\n  const [formData, setFormData] = useState({\r\n    characterName: \"\",\r\n    backstory: \"\",\r\n    description: \"\",\r\n    englishVA: \"\",\r\n    japaneseVA: \"\",\r\n    motionCapture: \"\",\r\n    spriteURL: \"\",\r\n  })\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState(\"\")\r\n  const [success, setSuccess] = useState(\"\")\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n    const { name, value } = e.target\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      [name]: value,\r\n    }))\r\n  }\r\n\r\n  const handleAddCharacter = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n    setLoading(true)\r\n    setError(\"\")\r\n    setSuccess(\"\")\r\n\r\n    try {\r\n      const response = await fetch(\"/api/characters\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(formData),\r\n      })\r\n\r\n      if (!response.ok) {\r\n        setError(\"Failed to add character\")\r\n        return\r\n      }\r\n\r\n      setSuccess(\"Character added successfully!\")\r\n      setFormData({\r\n        characterName: \"\",\r\n        backstory: \"\",\r\n        description: \"\",\r\n        englishVA: \"\",\r\n        japaneseVA: \"\",\r\n        motionCapture: \"\",\r\n        spriteURL: \"\",\r\n      })\r\n\r\n      // Refresh characters list\r\n      fetchCharacters()\r\n    } catch (err) {\r\n      setError(\"An error occurred\")\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const fetchCharacters = async () => {\r\n    try {\r\n      const response = await fetch(\"/api/characters\")\r\n      const data = await response.json()\r\n      setCharacters(data.characters || [])\r\n    } catch (err) {\r\n      console.error(\"Failed to fetch characters:\", err)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <form onSubmit={handleAddCharacter} className=\"space-y-4 p-4 bg-primary/5 rounded border-2 border-primary\">\r\n        <h3 className=\"text-lg font-bold text-primary\">Add Character</h3>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium mb-2 text-foreground\">Character Name *</label>\r\n            <Input\r\n              type=\"text\"\r\n              name=\"characterName\"\r\n              placeholder=\"Enter character name\"\r\n              value={formData.characterName}\r\n              onChange={handleChange}\r\n              required\r\n              className=\"border-primary bg-background\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium mb-2 text-foreground\">English Voice Actor</label>\r\n            <Input\r\n              type=\"text\"\r\n              name=\"englishVA\"\r\n              placeholder=\"Voice actor name\"\r\n              value={formData.englishVA}\r\n              onChange={handleChange}\r\n              className=\"border-primary bg-background\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium mb-2 text-foreground\">Japanese Voice Actor</label>\r\n            <Input\r\n              type=\"text\"\r\n              name=\"japaneseVA\"\r\n              placeholder=\"Japanese VA name\"\r\n              value={formData.japaneseVA}\r\n              onChange={handleChange}\r\n              className=\"border-primary bg-background\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium mb-2 text-foreground\">Motion Capture Actor</label>\r\n            <Input\r\n              type=\"text\"\r\n              name=\"motionCapture\"\r\n              placeholder=\"Motion capture name\"\r\n              value={formData.motionCapture}\r\n              onChange={handleChange}\r\n              className=\"border-primary bg-background\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium mb-2 text-foreground\">Backstory</label>\r\n          <textarea\r\n            name=\"backstory\"\r\n            placeholder=\"Character backstory\"\r\n            value={formData.backstory}\r\n            onChange={handleChange}\r\n            rows={3}\r\n            className=\"w-full px-3 py-2 border-2 border-primary rounded bg-background text-foreground\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium mb-2 text-foreground\">Description</label>\r\n          <textarea\r\n            name=\"description\"\r\n            placeholder=\"Character description\"\r\n            value={formData.description}\r\n            onChange={handleChange}\r\n            rows={3}\r\n            className=\"w-full px-3 py-2 border-2 border-primary rounded bg-background text-foreground\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium mb-2 text-foreground\">Sprite URL</label>\r\n          <Input\r\n            type=\"url\"\r\n            name=\"spriteURL\"\r\n            placeholder=\"https://example.com/sprite.png\"\r\n            value={formData.spriteURL}\r\n            onChange={handleChange}\r\n            className=\"border-primary bg-background\"\r\n          />\r\n        </div>\r\n\r\n        {error && <div className=\"p-2 bg-accent/10 border border-accent text-accent rounded text-sm\">{error}</div>}\r\n\r\n        {success && <div className=\"p-2 bg-accent/10 border border-accent text-accent rounded text-sm\">{success}</div>}\r\n\r\n        <Button\r\n          type=\"submit\"\r\n          disabled={loading}\r\n          className=\"w-full bg-accent text-accent-foreground hover:bg-accent/90 border-2 border-accent\"\r\n        >\r\n          <Plus size={20} className=\"mr-2\" />\r\n          {loading ? \"Adding...\" : \"Add Character\"}\r\n        </Button>\r\n      </form>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1952, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/components/map-form.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport type React from \"react\"\r\n\r\nimport { useState } from \"react\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Plus } from \"lucide-react\"\r\n\r\nexport function MapForm() {\r\n  const [maps, setMaps] = useState<any[]>([])\r\n  const [formData, setFormData] = useState({\r\n    mapName: \"\",\r\n    floorName: \"\",\r\n    description: \"\",\r\n    mapURL: \"\",\r\n  })\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState(\"\")\r\n  const [success, setSuccess] = useState(\"\")\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n    const { name, value } = e.target\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      [name]: value,\r\n    }))\r\n  }  \r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n    setLoading(true)\r\n    setError(\"\")\r\n    setSuccess(\"\")\r\n\r\n    try {\r\n      const response = await fetch(\"/api/maps\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(formData),\r\n      })\r\n\r\n      if (!response.ok) {\r\n        setError(\"Failed to add map\")\r\n        return\r\n      }\r\n\r\n      setSuccess(\"Map added successfully!\")\r\n      setFormData({\r\n        mapName: \"\",\r\n        floorName: \"\",\r\n        description: \"\",\r\n        mapURL: \"\",\r\n      })\r\n    } catch (err) {\r\n      setError(\"An error occurred\")\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const fetchMaps = async () => {\r\n    try {\r\n      const response = await fetch(\"/api/maps\")\r\n      const data = await response.json()\r\n      setMaps(data.maps || [])\r\n    } catch (err) {\r\n      console.error(\"Failed to fetch maps:\", err)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className=\"space-y-4 p-4 bg-primary/5 rounded border-2 border-primary\">\r\n      <h3 className=\"text-lg font-bold text-primary\">Add Map</h3>\r\n\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n        <div>\r\n          <label className=\"block text-sm font-medium mb-2 text-foreground\">Map Name *</label>\r\n          <Input\r\n            type=\"text\"\r\n            name=\"mapName\"\r\n            placeholder=\"Enter map name\"\r\n            value={formData.mapName}\r\n            onChange={handleChange}\r\n            required\r\n            className=\"border-primary bg-background\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium mb-2 text-foreground\">Floor Name (e.g. 1F, 3B)</label>\r\n          <Input\r\n            type=\"text\"\r\n            name=\"floorName\"\r\n            placeholder=\"Floor designation\"\r\n            value={formData.floorName}\r\n            onChange={handleChange}\r\n            className=\"border-primary bg-background\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <div>\r\n        <label className=\"block text-sm font-medium mb-2 text-foreground\">Description *</label>\r\n        <textarea\r\n          name=\"description\"\r\n          placeholder=\"Map description\"\r\n          value={formData.description}\r\n          onChange={handleChange}\r\n          required\r\n          rows={4}\r\n          className=\"w-full px-3 py-2 border-2 border-primary rounded bg-background text-foreground\"\r\n        />\r\n      </div>\r\n\r\n      <div>\r\n        <label className=\"block text-sm font-medium mb-2 text-foreground\">Map Image URL</label>\r\n        <Input\r\n          type=\"url\"\r\n          name=\"mapURL\"\r\n          placeholder=\"https://example.com/map.png\"\r\n          value={formData.mapURL}\r\n          onChange={handleChange}\r\n          className=\"border-primary bg-background\"\r\n        />\r\n      </div>\r\n\r\n      {error && <div className=\"p-2 bg-accent/10 border border-accent text-accent rounded text-sm\">{error}</div>}\r\n\r\n      {success && <div className=\"p-2 bg-accent/10 border border-accent text-accent rounded text-sm\">{success}</div>}\r\n\r\n      <Button\r\n        type=\"submit\"\r\n        disabled={loading}\r\n        className=\"w-full bg-accent text-accent-foreground hover:bg-accent/90 border-2 border-accent\"\r\n      >\r\n        <Plus size={20} className=\"mr-2\" />\r\n        {loading ? \"Adding...\" : \"Add Map\"}\r\n      </Button>\r\n    </form>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAIA;AACA;AACA;AACA;;;AAPA;;;;;AASO,SAAS;;IACd,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAQ,EAAE;IAC1C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;QACvC,SAAS;QACT,WAAW;QACX,aAAa;QACb,QAAQ;IACV;IACA,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,MAAM,eAAe,CAAC;QACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM;QAChC,YAAY,CAAC,OAAS,CAAC;gBACrB,GAAG,IAAI;gBACP,CAAC,KAAK,EAAE;YACV,CAAC;IACH;IAEA,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAChB,WAAW;QACX,SAAS;QACT,WAAW;QAEX,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,aAAa;gBACxC,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;YACvB;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,SAAS;gBACT;YACF;YAEA,WAAW;YACX,YAAY;gBACV,SAAS;gBACT,WAAW;gBACX,aAAa;gBACb,QAAQ;YACV;QACF,EAAE,OAAO,KAAK;YACZ,SAAS;QACX,SAAU;YACR,WAAW;QACb;IACF;IAEA,MAAM,YAAY;QAChB,IAAI;YACF,MAAM,WAAW,MAAM,MAAM;YAC7B,MAAM,OAAO,MAAM,SAAS,IAAI;YAChC,QAAQ,KAAK,IAAI,IAAI,EAAE;QACzB,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,yBAAyB;QACzC;IACF;IAEA,qBACE,6LAAC;QAAK,UAAU;QAAc,WAAU;;0BACtC,6LAAC;gBAAG,WAAU;0BAAiC;;;;;;0BAE/C,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;;0CACC,6LAAC;gCAAM,WAAU;0CAAiD;;;;;;0CAClE,6LAAC,sIAAK;gCACJ,MAAK;gCACL,MAAK;gCACL,aAAY;gCACZ,OAAO,SAAS,OAAO;gCACvB,UAAU;gCACV,QAAQ;gCACR,WAAU;;;;;;;;;;;;kCAId,6LAAC;;0CACC,6LAAC;gCAAM,WAAU;0CAAiD;;;;;;0CAClE,6LAAC,sIAAK;gCACJ,MAAK;gCACL,MAAK;gCACL,aAAY;gCACZ,OAAO,SAAS,SAAS;gCACzB,UAAU;gCACV,WAAU;;;;;;;;;;;;;;;;;;0BAKhB,6LAAC;;kCACC,6LAAC;wBAAM,WAAU;kCAAiD;;;;;;kCAClE,6LAAC;wBACC,MAAK;wBACL,aAAY;wBACZ,OAAO,SAAS,WAAW;wBAC3B,UAAU;wBACV,QAAQ;wBACR,MAAM;wBACN,WAAU;;;;;;;;;;;;0BAId,6LAAC;;kCACC,6LAAC;wBAAM,WAAU;kCAAiD;;;;;;kCAClE,6LAAC,sIAAK;wBACJ,MAAK;wBACL,MAAK;wBACL,aAAY;wBACZ,OAAO,SAAS,MAAM;wBACtB,UAAU;wBACV,WAAU;;;;;;;;;;;;YAIb,uBAAS,6LAAC;gBAAI,WAAU;0BAAqE;;;;;;YAE7F,yBAAW,6LAAC;gBAAI,WAAU;0BAAqE;;;;;;0BAEhG,6LAAC,wIAAM;gBACL,MAAK;gBACL,UAAU;gBACV,WAAU;;kCAEV,6LAAC,6MAAI;wBAAC,MAAM;wBAAI,WAAU;;;;;;oBACzB,UAAU,cAAc;;;;;;;;;;;;;AAIjC;GApIgB;KAAA"}},
    {"offset": {"line": 2215, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/components/mob-form.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport type React from \"react\"\r\n\r\nimport { useState } from \"react\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Plus } from \"lucide-react\"\r\n\r\nexport function MobForm() {\r\n  const [formData, setFormData] = useState({\r\n    mobName: \"\",\r\n    mobType: \"\",\r\n    description: \"\",\r\n    weakness: \"\",\r\n    mobSpriteURL: \"\",\r\n    spawnNotes: \"\",\r\n  })\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState(\"\")\r\n  const [success, setSuccess] = useState(\"\")\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n    const { name, value } = e.target\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      [name]: value,\r\n    }))\r\n  }\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n    setLoading(true)\r\n    setError(\"\")\r\n    setSuccess(\"\")\r\n\r\n    try {\r\n      const response = await fetch(\"/api/mobs\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(formData),\r\n      })\r\n\r\n      if (!response.ok) {\r\n        setError(\"Failed to add enemy\")\r\n        return\r\n      }\r\n\r\n      setSuccess(\"Enemy added successfully!\")\r\n      setFormData({\r\n        mobName: \"\",\r\n        mobType: \"\",\r\n        description: \"\",\r\n        weakness: \"\",\r\n        mobSpriteURL: \"\",\r\n        spawnNotes: \"\",\r\n      })\r\n    } catch (err) {\r\n      setError(\"An error occurred\")\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className=\"space-y-4 p-4 bg-primary/5 rounded border-2 border-primary\">\r\n      <h3 className=\"text-lg font-bold text-primary\">Add Enemy</h3>\r\n\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n        <div>\r\n          <label className=\"block text-sm font-medium mb-2 text-foreground\">Enemy Name *</label>\r\n          <Input\r\n            type=\"text\"\r\n            name=\"mobName\"\r\n            placeholder=\"Enter enemy name\"\r\n            value={formData.mobName}\r\n            onChange={handleChange}\r\n            required\r\n            className=\"border-primary bg-background\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium mb-2 text-foreground\">\r\n            Enemy Type (e.g. Boss, Regular, Mini-boss)\r\n          </label>\r\n          <Input\r\n            type=\"text\"\r\n            name=\"mobType\"\r\n            placeholder=\"Enemy classification\"\r\n            value={formData.mobType}\r\n            onChange={handleChange}\r\n            className=\"border-primary bg-background\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium mb-2 text-foreground\">Weakness</label>\r\n          <Input\r\n            type=\"text\"\r\n            name=\"weakness\"\r\n            placeholder=\"Element or weakness\"\r\n            value={formData.weakness}\r\n            onChange={handleChange}\r\n            className=\"border-primary bg-background\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium mb-2 text-foreground\">Sprite URL</label>\r\n          <Input\r\n            type=\"url\"\r\n            name=\"mobSpriteURL\"\r\n            placeholder=\"https://example.com/sprite.png\"\r\n            value={formData.mobSpriteURL}\r\n            onChange={handleChange}\r\n            className=\"border-primary bg-background\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <div>\r\n        <label className=\"block text-sm font-medium mb-2 text-foreground\">Description</label>\r\n        <textarea\r\n          name=\"description\"\r\n          placeholder=\"Enemy description and abilities\"\r\n          value={formData.description}\r\n          onChange={handleChange}\r\n          rows={3}\r\n          className=\"w-full px-3 py-2 border-2 border-primary rounded bg-background text-foreground\"\r\n        />\r\n      </div>\r\n\r\n      <div>\r\n        <label className=\"block text-sm font-medium mb-2 text-foreground\">Spawn Notes</label>\r\n        <textarea\r\n          name=\"spawnNotes\"\r\n          placeholder=\"Where and when this enemy spawns\"\r\n          value={formData.spawnNotes}\r\n          onChange={handleChange}\r\n          rows={3}\r\n          className=\"w-full px-3 py-2 border-2 border-primary rounded bg-background text-foreground\"\r\n        />\r\n      </div>\r\n\r\n      {error && <div className=\"p-2 bg-accent/10 border border-accent text-accent rounded text-sm\">{error}</div>}\r\n\r\n      {success && <div className=\"p-2 bg-accent/10 border border-accent text-accent rounded text-sm\">{success}</div>}\r\n\r\n      <Button\r\n        type=\"submit\"\r\n        disabled={loading}\r\n        className=\"w-full bg-accent text-accent-foreground hover:bg-accent/90 border-2 border-accent\"\r\n      >\r\n        <Plus size={20} className=\"mr-2\" />\r\n        {loading ? \"Adding...\" : \"Add Enemy\"}\r\n      </Button>\r\n    </form>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2527, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/components/add-game-form.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport type React from \"react\"\r\n\r\nimport { useState } from \"react\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\"\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\"\r\nimport { CharacterForm } from \"./character-form\"\r\nimport { MapForm } from \"./map-form\"\r\nimport { MobForm } from \"./mob-form\"\r\n// import { StoryArcForm } from \"./story-arc-form\"\r\n\r\ninterface AddGameFormProps {\r\n  onGameAdded: () => void\r\n}\r\n\r\nexport function AddGameForm({ onGameAdded }: AddGameFormProps) {\r\n  const [formData, setFormData] = useState({\r\n    title: \"\",\r\n    plotSummary: \"\",\r\n    releaseDate: \"\",\r\n    gameCoverURL: \"\",\r\n    gameLogoURL: \"\",\r\n    multiplayerSupport: false,\r\n  })\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState(\"\")\r\n  const [success, setSuccess] = useState(\"\")\r\n  const [activeTab, setActiveTab] = useState(\"game\")\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n    const { name, value, type } = e.target as HTMLInputElement\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      [name]: type === \"checkbox\" ? (e.target as HTMLInputElement).checked : value,\r\n    }))\r\n  }\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n    setLoading(true)\r\n    setError(\"\")\r\n    setSuccess(\"\")\r\n\r\n    try {\r\n      const response = await fetch(\"/api/games\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(formData),\r\n      })\r\n\r\n      const data = await response.json()\r\n\r\n      if (!response.ok) {\r\n        setError(data.error || \"Failed to add game\")\r\n        return\r\n      }\r\n\r\n      setSuccess(\"Game added successfully!\")\r\n      setFormData({\r\n        title: \"\",\r\n        plotSummary: \"\",\r\n        releaseDate: \"\",\r\n        gameCoverURL: \"\",\r\n        gameLogoURL: \"\",\r\n        multiplayerSupport: false,\r\n      })\r\n\r\n      setTimeout(() => {\r\n        onGameAdded()\r\n      }, 1500)\r\n    } catch (err) {\r\n      setError(\"An error occurred. Please try again.\")\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto\">\r\n      <Card className=\"border-2 border-primary bg-card\">\r\n        <CardHeader className=\"border-b-2 border-primary\">\r\n          <CardTitle className=\"text-2xl text-primary\">Game Database Management</CardTitle>\r\n          <CardDescription>Add and manage game data and related entities</CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"pt-6\">\r\n          <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\r\n            <TabsList className=\"grid w-full grid-cols-5 bg-primary/10 border-2 border-primary\">\r\n              <TabsTrigger\r\n                value=\"game\"\r\n                className=\"data-[state=active]:bg-primary data-[state=active]:text-primary-foreground\"\r\n              >\r\n                Game\r\n              </TabsTrigger>\r\n              <TabsTrigger\r\n                value=\"characters\"\r\n                className=\"data-[state=active]:bg-primary data-[state=active]:text-primary-foreground\"\r\n              >\r\n                Characters\r\n              </TabsTrigger>\r\n              <TabsTrigger\r\n                value=\"maps\"\r\n                className=\"data-[state=active]:bg-primary data-[state=active]:text-primary-foreground\"\r\n              >\r\n                Maps\r\n              </TabsTrigger>\r\n              <TabsTrigger\r\n                value=\"mobs\"\r\n                className=\"data-[state=active]:bg-primary data-[state=active]:text-primary-foreground\"\r\n              >\r\n                Enemies\r\n              </TabsTrigger>\r\n              <TabsTrigger\r\n                value=\"storyarcs\"\r\n                className=\"data-[state=active]:bg-primary data-[state=active]:text-primary-foreground\"\r\n              >\r\n                Story Arcs\r\n              </TabsTrigger>\r\n            </TabsList>\r\n\r\n            {/* Game Tab */}\r\n            <TabsContent value=\"game\" className=\"space-y-4 mt-4\">\r\n              <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium mb-2 text-foreground\">Game Title *</label>\r\n                  <Input\r\n                    type=\"text\"\r\n                    name=\"title\"\r\n                    placeholder=\"Enter game title\"\r\n                    value={formData.title}\r\n                    onChange={handleChange}\r\n                    required\r\n                    className=\"border-primary bg-background\"\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium mb-2 text-foreground\">Release Date *</label>\r\n                  <Input\r\n                    type=\"date\"\r\n                    name=\"releaseDate\"\r\n                    value={formData.releaseDate}\r\n                    onChange={handleChange}\r\n                    required\r\n                    className=\"border-primary bg-background\"\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium mb-2 text-foreground\">Plot Summary</label>\r\n                  <textarea\r\n                    name=\"plotSummary\"\r\n                    placeholder=\"Enter plot summary\"\r\n                    value={formData.plotSummary}\r\n                    onChange={handleChange}\r\n                    rows={4}\r\n                    className=\"w-full px-3 py-2 border-2 border-primary rounded bg-background text-foreground\"\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium mb-2 text-foreground\">Cover Image URL</label>\r\n                  <Input\r\n                    type=\"url\"\r\n                    name=\"gameCoverURL\"\r\n                    placeholder=\"https://example.com/cover.jpg\"\r\n                    value={formData.gameCoverURL}\r\n                    onChange={handleChange}\r\n                    className=\"border-primary bg-background\"\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium mb-2 text-foreground\">Logo Image URL</label>\r\n                  <Input\r\n                    type=\"url\"\r\n                    name=\"gameLogoURL\"\r\n                    placeholder=\"https://example.com/logo.jpg\"\r\n                    value={formData.gameLogoURL}\r\n                    onChange={handleChange}\r\n                    className=\"border-primary bg-background\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-2\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    id=\"multiplayerSupport\"\r\n                    name=\"multiplayerSupport\"\r\n                    checked={formData.multiplayerSupport}\r\n                    onChange={handleChange}\r\n                    className=\"rounded border-primary\"\r\n                  />\r\n                  <label htmlFor=\"multiplayerSupport\" className=\"text-sm text-foreground\">\r\n                    Multiplayer Support\r\n                  </label>\r\n                </div>\r\n\r\n                {error && <div className=\"p-3 bg-accent/10 border border-accent text-accent rounded\">{error}</div>}\r\n\r\n                {success && <div className=\"p-3 bg-accent/10 border border-accent text-accent rounded\">{success}</div>}\r\n\r\n                <Button\r\n                  type=\"submit\"\r\n                  disabled={loading}\r\n                  className=\"w-full bg-primary text-primary-foreground hover:bg-primary/90 border-2 border-primary\"\r\n                >\r\n                  {loading ? \"Adding...\" : \"Add Game\"}\r\n                </Button>\r\n              </form>\r\n            </TabsContent>\r\n\r\n            {/* Characters Tab */}\r\n            <TabsContent value=\"characters\" className=\"mt-4\">\r\n              <CharacterForm />\r\n            </TabsContent>\r\n\r\n            {/* Maps Tab */}\r\n            <TabsContent value=\"maps\" className=\"mt-4\">\r\n              <MapForm />\r\n            </TabsContent>\r\n\r\n            {/* Mobs Tab */}\r\n            <TabsContent value=\"mobs\" className=\"mt-4\">\r\n              <MobForm />\r\n            </TabsContent>\r\n\r\n            {/* Story Arcs Tab */}\r\n            {/* <TabsContent value=\"storyarcs\" className=\"mt-4\">\r\n              <StoryArcForm />\r\n            </TabsContent> */}\r\n          </Tabs>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2986, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/components/rating-edit-modal.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState } from \"react\"\r\nimport { Card, CardHeader, CardTitle, CardDescription, CardContent } from \"@/components/ui/card\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { X } from \"lucide-react\"\r\n\r\ninterface RatingEditModalProps {\r\n  rating: any\r\n  onClose: () => void\r\n  onSave: () => void\r\n}\r\n\r\nexport function RatingEditModal({ rating, onClose, onSave }: RatingEditModalProps) {\r\n  const [formData, setFormData] = useState({\r\n    rating: rating.rating || \"\",\r\n    review: rating.review || \"\",\r\n    personalbest: rating.personalbest || \"\"\r\n  })\r\n\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState(\"\")\r\n  const [success, setSuccess] = useState(\"\")\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n    const { name, value } = e.target\r\n    setFormData(prev => ({ ...prev, [name]: value }))\r\n  }\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n    setLoading(true)\r\n    setError(\"\")\r\n    setSuccess(\"\")\r\n\r\n    try {\r\n      const res = await fetch(`/api/ratings/${rating.ratingid}`, {\r\n        method: \"PUT\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          rating: Number(formData.rating),\r\n          review: formData.review,\r\n          personalbest: formData.personalbest,\r\n        }),\r\n      })\r\n\r\n      if (!res.ok) {\r\n        const err = await res.json().catch(() => ({}))\r\n        setError(err.error || \"failed to update rating\")\r\n        return\r\n      }\r\n\r\n      setSuccess(\"rating updated!\")\r\n      setTimeout(() => onSave(), 800)\r\n    } catch (err: any) {\r\n      setError(err.message || \"something went wrong\")\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto\">\r\n      <Card className=\"w-full max-w-lg border-2 border-primary bg-card my-8\">\r\n        <CardHeader className=\"border-b-2 border-primary flex justify-between items-start\">\r\n          <div>\r\n            <CardTitle className=\"text-2xl\">Edit Rating</CardTitle>\r\n            <CardDescription>{rating.game?.title}</CardDescription>\r\n          </div>\r\n          <button onClick={onClose} className=\"p-1 hover:bg-primary/10 rounded\">\r\n            <X size={24} />\r\n          </button>\r\n        </CardHeader>\r\n\r\n        <CardContent className=\"pt-6\">\r\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n            {/* Rating */}\r\n            <div>\r\n              <label className=\"block text-sm mb-1\">Rating (1 â€“ 5)</label>\r\n              <Input\r\n                type=\"number\"\r\n                required\r\n                name=\"rating\"\r\n                value={formData.rating}\r\n                onChange={handleChange}\r\n                min={1}\r\n                max={10}\r\n              />\r\n            </div>\r\n\r\n            {/* Review */}\r\n            <div>\r\n              <label className=\"block text-sm mb-1\">Review</label>\r\n              <textarea\r\n                name=\"review\"\r\n                value={formData.review}\r\n                onChange={handleChange}\r\n                rows={3}\r\n                className=\"w-full px-3 py-2 border rounded bg-background\"\r\n                placeholder=\"write a review...\"\r\n              />\r\n            </div>\r\n\r\n            {/* Personal Best */}\r\n            <div>\r\n              <label className=\"block text-sm mb-1\">Personal Best (optional)</label>\r\n              <Input\r\n                name=\"personalbest\"\r\n                value={formData.personalbest}\r\n                onChange={handleChange}\r\n                placeholder=\"A, S+, etc\"\r\n              />\r\n            </div>\r\n\r\n            {error && <p className=\"text-red-500 text-sm\">{error}</p>}\r\n            {success && <p className=\"text-green-500 text-sm\">{success}</p>}\r\n\r\n            <div className=\"flex gap-2 pt-3\">\r\n              <Button type=\"submit\" disabled={loading} className=\"flex-1\">\r\n                {loading ? \"saving...\" : \"save\"}\r\n              </Button>\r\n              <Button type=\"button\" onClick={onClose} disabled={loading} variant=\"secondary\" className=\"flex-1\">\r\n                cancel\r\n              </Button>\r\n            </div>\r\n          </form>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3273, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/components/rating-form.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState } from \"react\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Plus } from \"lucide-react\"\r\n\r\ninterface RatingFormProps {\r\n    onSave?: () => void\r\n}\r\n\r\nexport function RatingForm({ onSave }: RatingFormProps) {\r\n    const [formData, setFormData] = useState({\r\n        rating: \"\",\r\n        review: \"\",\r\n        personalbest: \"\",\r\n        gameId: \"\",\r\n    })\r\n    const [loading, setLoading] = useState(false)\r\n    const [error, setError] = useState(\"\")\r\n    const [success, setSuccess] = useState(\"\")\r\n\r\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n        const { name, value } = e.target\r\n        setFormData((prev) => ({ ...prev, [name]: value }))\r\n    }\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault()\r\n        setLoading(true)\r\n        setError(\"\")\r\n        setSuccess(\"\")\r\n\r\n        // Validate that gameId and rating are not just empty strings from the form\r\n        if (!formData.rating || !formData.gameId) {\r\n            setError(\"Rating and Game ID are required.\")\r\n            setLoading(false)\r\n            return\r\n        }\r\n\r\n        try {\r\n            const res = await fetch(\"/api/ratings\", {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/json\" },\r\n                body: JSON.stringify(formData),\r\n                // FIX: Including credentials to send Supabase session cookies\r\n                credentials: \"include\",\r\n            })\r\n\r\n\r\n            if (res.status === 401) {\r\n                console.error('Submission failed: User is not authenticated.');\r\n                return;\r\n            }\r\n\r\n            // Check for specific error message from the API response body\r\n            if (!res.ok) {\r\n                let errorMessage = \"Failed to add rating\";\r\n                try {\r\n                    const errorData = await res.json();\r\n                    if (errorData.error) {\r\n                        errorMessage = errorData.error;\r\n                    }\r\n                } catch (e) {\r\n                    // Ignore JSON parsing error if response is not JSON\r\n                }\r\n                throw new Error(errorMessage)\r\n            }\r\n\r\n            setSuccess(\"Rating added!\")\r\n            setFormData({ rating: \"\", review: \"\", personalbest: \"\", gameId: \"\" })\r\n            onSave?.()\r\n        } catch (err: any) {\r\n            setError(err.message || \"An error occurred\")\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    return (\r\n        <form onSubmit={handleSubmit} className=\"space-y-4 p-4 border rounded bg-primary/5\">\r\n            <Input\r\n                type=\"number\"\r\n                name=\"rating\"\r\n                placeholder=\"stars (1 - 5)\"\r\n                value={formData.rating}\r\n                onChange={handleChange}\r\n                required\r\n            />\r\n            <Input\r\n                type=\"text\"\r\n                name=\"review\"\r\n                placeholder=\"leave a review!\"\r\n                value={formData.review}\r\n                onChange={handleChange}\r\n            />\r\n            <Input\r\n                type=\"text\"\r\n                name=\"personalbest\"\r\n                placeholder=\"personal best (S+, S, A, etc.)\"\r\n                value={formData.personalbest}\r\n                onChange={handleChange}\r\n            />\r\n            <Input\r\n                type=\"number\"\r\n                name=\"gameId\"\r\n                placeholder=\"game ID\"\r\n                value={formData.gameId}\r\n                onChange={handleChange}\r\n                required\r\n            />\r\n\r\n            {error && <p className=\"text-red-500\">{error}</p>}\r\n            {success && <p className=\"text-green-500\">{success}</p>}\r\n\r\n            <Button type=\"submit\" disabled={loading} className=\"w-full flex items-center justify-center gap-2\">\r\n                <Plus size={16} />\r\n                {loading ? \"Adding...\" : \"Add Rating\"}\r\n            </Button>\r\n        </form>\r\n    )\r\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;;;AALA;;;;;AAWO,SAAS,WAAW,EAAE,MAAM,EAAmB;;IAClD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;QACrC,QAAQ;QACR,QAAQ;QACR,cAAc;QACd,QAAQ;IACZ;IACA,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,MAAM,eAAe,CAAC;QAClB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM;QAChC,YAAY,CAAC,OAAS,CAAC;gBAAE,GAAG,IAAI;gBAAE,CAAC,KAAK,EAAE;YAAM,CAAC;IACrD;IAEA,MAAM,eAAe,OAAO;QACxB,EAAE,cAAc;QAChB,WAAW;QACX,SAAS;QACT,WAAW;QAEX,2EAA2E;QAC3E,IAAI,CAAC,SAAS,MAAM,IAAI,CAAC,SAAS,MAAM,EAAE;YACtC,SAAS;YACT,WAAW;YACX;QACJ;QAEA,IAAI;YACA,MAAM,MAAM,MAAM,MAAM,gBAAgB;gBACpC,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;gBACrB,8DAA8D;gBAC9D,aAAa;YACjB;YAGA,IAAI,IAAI,MAAM,KAAK,KAAK;gBACpB,QAAQ,KAAK,CAAC;gBACd;YACJ;YAEA,8DAA8D;YAC9D,IAAI,CAAC,IAAI,EAAE,EAAE;gBACT,IAAI,eAAe;gBACnB,IAAI;oBACA,MAAM,YAAY,MAAM,IAAI,IAAI;oBAChC,IAAI,UAAU,KAAK,EAAE;wBACjB,eAAe,UAAU,KAAK;oBAClC;gBACJ,EAAE,OAAO,GAAG;gBACR,oDAAoD;gBACxD;gBACA,MAAM,IAAI,MAAM;YACpB;YAEA,WAAW;YACX,YAAY;gBAAE,QAAQ;gBAAI,QAAQ;gBAAI,cAAc;gBAAI,QAAQ;YAAG;YACnE;QACJ,EAAE,OAAO,KAAU;YACf,SAAS,IAAI,OAAO,IAAI;QAC5B,SAAU;YACN,WAAW;QACf;IACJ;IAEA,qBACI,6LAAC;QAAK,UAAU;QAAc,WAAU;;0BACpC,6LAAC,sIAAK;gBACF,MAAK;gBACL,MAAK;gBACL,aAAY;gBACZ,OAAO,SAAS,MAAM;gBACtB,UAAU;gBACV,QAAQ;;;;;;0BAEZ,6LAAC,sIAAK;gBACF,MAAK;gBACL,MAAK;gBACL,aAAY;gBACZ,OAAO,SAAS,MAAM;gBACtB,UAAU;;;;;;0BAEd,6LAAC,sIAAK;gBACF,MAAK;gBACL,MAAK;gBACL,aAAY;gBACZ,OAAO,SAAS,YAAY;gBAC5B,UAAU;;;;;;0BAEd,6LAAC,sIAAK;gBACF,MAAK;gBACL,MAAK;gBACL,aAAY;gBACZ,OAAO,SAAS,MAAM;gBACtB,UAAU;gBACV,QAAQ;;;;;;YAGX,uBAAS,6LAAC;gBAAE,WAAU;0BAAgB;;;;;;YACtC,yBAAW,6LAAC;gBAAE,WAAU;0BAAkB;;;;;;0BAE3C,6LAAC,wIAAM;gBAAC,MAAK;gBAAS,UAAU;gBAAS,WAAU;;kCAC/C,6LAAC,6MAAI;wBAAC,MAAM;;;;;;oBACX,UAAU,cAAc;;;;;;;;;;;;;AAIzC;GA9GgB;KAAA"}},
    {"offset": {"line": 3462, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/components/ratings-browser.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { RefreshCw, Edit2, Trash2, Star, User, PlusCircleIcon, MessageCircle, Mail, MailPlus } from \"lucide-react\"\r\nimport { RatingEditModal } from \"./rating-edit-modal\"\r\nimport { RatingForm } from \"./rating-form\"\r\n\r\ninterface RatingBrowserProps {\r\n    ratings?: any[]\r\n    loading?: boolean\r\n    onRefresh?: () => void\r\n    onAddRating?: () => void\r\n}\r\n\r\n// FIX: Updated interface to match API response structure (e.g., 'games' instead of 'game')\r\ninterface Rating {\r\n    ratingid: number\r\n    rating?: number\r\n    review?: string\r\n    reviewtimestamp?: string\r\n    personalbest?: string\r\n\r\n    // CRITICAL FIX: The nested object key must match the table name used in the API join.\r\n    games: { // Assuming your games table is aliased/referenced as 'games'\r\n        gameid: number // Assuming 'id' is the primary key of the games table\r\n        title: string\r\n    }\r\n    users?: { // Optional user data\r\n        username?: string\r\n        // Add other user fields if needed\r\n    }\r\n}\r\n\r\nexport function RatingsBrowser({ ratings: initialRatings = [], loading: initialLoading = false, onRefresh, onAddRating }: RatingBrowserProps) {\r\n    const [ratings, setRatings] = useState<Rating[]>(initialRatings)\r\n    const [loading, setLoading] = useState(initialLoading)\r\n    const [searchTerm, setSearchTerm] = useState(\"\")\r\n    const [addOpen, setAddOpen] = useState(false)\r\n    const [selectedRating, setSelectedRating] = useState<Rating | null>(null)\r\n    const [deletionConfirmed, setDeletionConfirmed] = useState(false) // Custom confirmation state\r\n\r\n    useEffect(() => {\r\n        fetchRatings()\r\n    }, [])\r\n\r\n    const fetchRatings = async () => {\r\n        setLoading(true)\r\n        try {\r\n            const res = await fetch(\"/api/ratings\")\r\n            const data = await res.json()\r\n            setRatings(data.ratings || [])\r\n        } catch (err) {\r\n            console.error(\"failed to fetch ratings:\", err)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    // Replaced window.confirm\r\n    const handleDelete = async (ratingId: number) => {\r\n        if (!deletionConfirmed) {\r\n            console.warn(\"Please confirm deletion by clicking the trash icon again.\")\r\n            setDeletionConfirmed(true);\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const res = await fetch(`/api/ratings/${ratingId}`, { method: \"DELETE\" })\r\n            if (res.ok) {\r\n                setRatings((prev) => prev.filter((r) => r.ratingid !== ratingId))\r\n            } else {\r\n                console.error(\"failed to delete rating:\", await res.json());\r\n            }\r\n        } catch (err) {\r\n            console.error(\"failed to delete rating:\", err)\r\n        } finally {\r\n            setDeletionConfirmed(false);\r\n        }\r\n    }\r\n\r\n    const filteredRatings = ratings\r\n        .sort((a, b) => (b.ratingid || 0) - (a.ratingid || 0))\r\n        .filter((r) =>\r\n            // CRITICAL FIX: Access 'games.title' instead of 'game.title'\r\n            (r.games?.title || \"\").toLowerCase().includes(searchTerm.toLowerCase())\r\n        )\r\n\r\n    return (\r\n        <div className=\"space-y-8 p-6\">\r\n            <div className=\"flex justify-between items-center pb-4 border-b\">\r\n                <h1 className=\"text-3xl font-bold flex items-center gap-2\">\r\n                    ratings <Star size={20} className=\"text-yellow-400\" />\r\n                </h1>\r\n                <div className=\"flex gap-2\">\r\n                    <Button onClick={() => setAddOpen(true)}>\r\n                        <MailPlus size={16} />\r\n                            add rating\r\n                    </Button>\r\n                    <Button onClick={fetchRatings} disabled={loading}>\r\n                        <RefreshCw className={loading ? \"animate-spin mr-2\" : \"mr-2\"} size={16} />\r\n                        refresh\r\n                    </Button>\r\n                </div>\r\n\r\n                {addOpen && (\r\n                    <div className=\"p-4 mt-4 border-2 border-primary rounded bg-primary/5\">\r\n                        <RatingForm\r\n                            onSave={() => {\r\n                                fetchRatings()\r\n                                setAddOpen(false)\r\n                            }}\r\n                        />\r\n                        <Button\r\n                            onClick={() => setAddOpen(false)}\r\n                            className=\"mt-2 w-full bg-accent text-accent-foreground border-2 border-accent hover:bg-accent/90\"\r\n                        >\r\n                            cancel\r\n                        </Button>\r\n                    </div>\r\n                )}\r\n\r\n            </div>\r\n\r\n            <Input\r\n                placeholder=\"search ratings by game name...\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n            />\r\n\r\n            {filteredRatings.length === 0 ? (\r\n                <Card>\r\n                    <CardContent className=\"py-10 text-center text-muted-foreground\">\r\n                        no ratings found.\r\n                    </CardContent>\r\n                </Card>\r\n            ) : (\r\n                <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\r\n                    {filteredRatings.map((rating, index) => (\r\n                        <Card key={index} className=\"transition hover:shadow-md\">\r\n                            <CardHeader className=\"flex flex-col gap-1\">\r\n                                {/* CRITICAL FIX: Access 'games.title' */}\r\n                                <CardTitle>{rating.games?.title || \"Unknown Game\"}</CardTitle>\r\n                                <CardDescription className=\"flex items-center text-sm text-gray-500\">\r\n                                    <User size={14} className=\"mr-1\" />\r\n                                    By: {rating.users?.username || 'Anonymous'}\r\n                                </CardDescription>\r\n                                <CardDescription className=\"font-semibold text-yellow-500\">\r\n                                    {rating.rating}/5\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-3\">\r\n                                <p className=\"text-sm text-muted-foreground line-clamp-3\">\r\n                                    {rating.review || \"no review written\"}\r\n                                </p>\r\n                                <div className=\"flex justify-between pt-2\">\r\n                                    <Button size=\"sm\" variant=\"outline\" onClick={() => setSelectedRating(rating)}>\r\n                                        <Edit2 size={14} />\r\n                                    </Button>\r\n                                    <Button\r\n                                        size=\"sm\"\r\n                                        variant={deletionConfirmed ? \"destructive\" : \"outline\"}\r\n                                        onClick={() => handleDelete(rating.ratingid)}\r\n                                    >\r\n                                        <Trash2 size={14} />\r\n                                    </Button>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    ))}\r\n                </div>\r\n            )}\r\n\r\n            {selectedRating && (\r\n                <RatingEditModal\r\n                    rating={selectedRating}\r\n                    onClose={() => setSelectedRating(null)}\r\n                    onSave={() => {\r\n                        fetchRatings()\r\n                        setSelectedRating(null)\r\n                    }}\r\n                />\r\n            )}\r\n        </div>\r\n    )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3814, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/components/dashboard-home.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Gamepad2, Users, Map, Zap, Plus, Eye, User as UserIconPlaceholder } from \"lucide-react\"\r\n\r\ninterface DashboardHomeProps {\r\n  games: any[]\r\n  characters: any[]\r\n  maps: any[]\r\n  mobs: any[]\r\n  userRole: \"dev\" | \"editor\" | \"viewer\" // Add possible roles\r\n  onNavigate: (view: \"home\" | \"browse\" | \"add\" | \"characters\" | \"maps\" | \"mobs\") => void\r\n}\r\n\r\nexport function DashboardHome({ games, characters, maps, mobs, userRole, onNavigate }: DashboardHomeProps) {\r\n\r\n  // --- 1. STATISTICS (NO CHANGE) ---\r\n  const stats = [\r\n    {\r\n      title: \"Total Games\",\r\n      value: games.length,\r\n      icon: Gamepad2,\r\n      color: \"text-primary\",\r\n      bgColor: \"bg-primary/10\",\r\n    },\r\n    {\r\n      title: \"Characters\",\r\n      value: characters.length,\r\n      icon: Users,\r\n      color: \"text-accent\",\r\n      bgColor: \"bg-accent/10\",\r\n    },\r\n    {\r\n      title: \"Maps\",\r\n      value: maps.length,\r\n      icon: Map,\r\n      color: \"text-primary\",\r\n      bgColor: \"bg-primary/10\",\r\n    },\r\n    {\r\n      title: \"Enemies\",\r\n      value: mobs.length,\r\n      icon: Zap,\r\n      color: \"text-accent\",\r\n      bgColor: \"bg-accent/10\",\r\n    },\r\n  ]\r\n\r\n  // --- 2. QUICK ACTIONS (MODIFIED FOR ROLE CHECK) ---\r\n  const quickActions: any[] = [] // Start with an empty array\r\n\r\n  // ðŸ”‘ Conditional check to include 'Add Game' only for 'dev' role\r\n  if (userRole === \"dev\") {\r\n    quickActions.push({\r\n      title: \"Add Game\",\r\n      description: \"Create a new game entry\",\r\n      icon: Plus,\r\n      action: () => onNavigate(\"add\"),\r\n      color: \"bg-primary text-primary-foreground hover:bg-primary/90\",\r\n    });\r\n  }\r\n\r\n  // 'Browse Games' is always available\r\n  quickActions.push({\r\n    title: \"Browse Games\",\r\n    description: \"View all games in the database\",\r\n    icon: Eye,\r\n    action: () => onNavigate(\"browse\"),\r\n    color: \"bg-accent text-accent-foreground hover:bg-accent/90\",\r\n  });\r\n\r\n\r\n  return (\r\n    <div className=\"space-y-8\">\r\n      {/* Hero Section (NO CHANGE) */}\r\n      <div className=\"bg-primary text-primary-foreground p-8 rounded-lg border-2 border-accent\">\r\n        <h1 className=\"text-4xl font-bold mb-2\">Welcome Page</h1>\r\n        <p className=\"text-lg opacity-90\">\r\n          Add whatever you'd like here tbh. Maybe some news, updates, or quick links? Ur marzi.\r\n        </p>\r\n      </div>\r\n\r\n      {/* Statistics Grid (NO CHANGE) */}\r\n      <div>\r\n        <h2 className=\"text-2xl font-bold text-primary mb-4\">Database Overview</h2>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n          {stats.map((stat, idx) => {\r\n            const Icon = stat.icon\r\n            return (\r\n              <Card key={idx} className=\"border-2 border-primary bg-card hover:border-accent transition-colors\">\r\n                <CardHeader className=\"pb-3\">\r\n                  <div className={`${stat.bgColor} w-12 h-12 rounded-lg flex items-center justify-center mb-2`}>\r\n                    <Icon className={`${stat.color} w-6 h-6`} />\r\n                  </div>\r\n                  <CardTitle className=\"text-sm text-muted-foreground\">{stat.title}</CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"text-3xl font-bold text-primary\">{stat.value}</div>\r\n                </CardContent>\r\n              </Card>\r\n            )\r\n          })}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Quick Actions (MODIFIED) */}\r\n      <div>\r\n        <h2 className=\"text-2xl font-bold text-primary mb-4\">Quick Actions</h2>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n          {quickActions.map((action, idx) => {\r\n            const Icon = action.icon\r\n            return (\r\n              <Button\r\n                key={idx}\r\n                onClick={action.action}\r\n                className={`${action.color} h-auto p-6 border-2 border-current justify-start flex-col items-start`}\r\n              >\r\n                <div className=\"flex items-center gap-3 w-full\">\r\n                  <Icon size={32} />\r\n                  <div className=\"text-left\">\r\n                    <div className=\"font-bold text-lg\">{action.title}</div>\r\n                    <div className=\"text-sm opacity-90\">{action.description}</div>\r\n                  </div>\r\n                </div>\r\n              </Button>\r\n            )\r\n          })}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Recent Games (NO CHANGE) */}\r\n      {games.length > 0 && (\r\n        <div>\r\n          <div className=\"flex justify-between items-center mb-4\">\r\n            <h2 className=\"text-2xl font-bold text-primary\">Recent Games</h2>\r\n            <Button\r\n              onClick={() => onNavigate(\"browse\")}\r\n              className=\"bg-accent text-accent-foreground hover:bg-accent/90\"\r\n            >\r\n              View All\r\n            </Button>\r\n          </div>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n            {games.slice(0, 3).map((game) => (\r\n              <Card\r\n                key={game.gameid}\r\n                className=\"border-2 border-primary hover:border-accent transition-colors bg-card cursor-pointer\"\r\n                onClick={() => onNavigate(\"browse\")}\r\n              >\r\n                <div className=\"w-full h-40 overflow-hidden rounded-t flex items-center justify-center p-4\">\r\n                  {game.gamelogourl ? (\r\n                    <img\r\n                      src={game.gamelogourl}\r\n                      alt={game.title}\r\n                      className=\"object-contain max-w-full max-h-full\"\r\n                      onError={(e) => { e.currentTarget.onerror = null; e.currentTarget.src = 'https://placehold.co/160x160/292524/ffffff?text=Logo'; }}\r\n                    />\r\n                  ) : (\r\n                    <Gamepad2 className=\"w-16 h-16 text-muted-foreground\" />\r\n                  )}\r\n                </div>\r\n                <CardHeader>\r\n                  <CardTitle className=\"text-primary line-clamp-1\">{game.title}</CardTitle>\r\n                  <CardDescription className=\"text-muted-foreground\">\r\n                    {new Date(game.releasedate).getFullYear()}\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <p className=\"text-sm line-clamp-2 text-muted-foreground\">{game.plotsummary}</p>\r\n                </CardContent>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Recent Characters (NO CHANGE) */}\r\n      {characters.length > 0 && (\r\n        <div className=\"mt-8\">\r\n          <div className=\"flex justify-between items-center mb-4\">\r\n            <h2 className=\"text-2xl font-bold text-primary\">Recent Characters</h2>\r\n            <Button\r\n              onClick={() => onNavigate(\"characters\")}\r\n              className=\"bg-accent text-accent-foreground hover:bg-accent/90\"\r\n            >\r\n              View All\r\n            </Button>\r\n          </div>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n            {characters.slice(0, 3).map((char) => (\r\n              <Card\r\n                key={char.characterid}\r\n                className=\"border-2 border-primary hover:border-accent transition-colors bg-card cursor-pointer\"\r\n                onClick={() => onNavigate(\"characters\")}\r\n              >\r\n                <div className=\"w-full h-40 overflow-hidden rounded-t flex items-center justify-center p-4\">\r\n                  {char.spriteurl ? (\r\n                    <img\r\n                      src={char.spriteurl}\r\n                      alt={char.name}\r\n                      className=\"object-contain max-w-full max-h-full\"\r\n                      onError={(e) => { e.currentTarget.onerror = null; e.currentTarget.src = 'https://placehold.co/160x160/292524/ffffff?text=Char'; }}\r\n                    />\r\n                  ) : (\r\n                    <UserIconPlaceholder className=\"w-16 h-16 text-muted-foreground\" />\r\n                  )}\r\n                </div>\r\n                <CardHeader>\r\n                  <CardTitle className=\"text-primary line-clamp-1\">{char.name}</CardTitle>\r\n                  <CardDescription className=\"text-muted-foreground\">\r\n                    {char.englishva && `English VA: ${char.englishva}`}\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <p className=\"text-sm line-clamp-2 text-muted-foreground\">{char.backstory}</p>\r\n                </CardContent>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <Card className=\"border-0 border-primary bg-primary/5\">\r\n      </Card>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4324, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/components/dashboard.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { GamesGallery } from \"@/components/games-gallery\"\r\nimport { AddGameForm } from \"@/components/add-game-form\"\r\nimport { RatingsBrowser } from \"@/components/ratings-browser\"\r\nimport { DashboardHome } from \"@/components/dashboard-home\"\r\nimport { Menu, Star, X } from \"lucide-react\"\r\n\r\n// --- Placeholder Components (kept for reference) ---\r\ninterface AddRatingFormProps {\r\n  gameId?: string;\r\n  onRatingAdded: () => void;\r\n  onCancel: () => void;\r\n}\r\nconst AddRatingForm = ({ gameId, onRatingAdded, onCancel }: AddRatingFormProps) => (\r\n  <div className=\"p-6 border rounded-lg space-y-4\">\r\n    <h2 className=\"text-2xl font-bold\">Add New Rating {gameId && `for Game ID: ${gameId}`}</h2>\r\n    <p className=\"text-muted-foreground\">This is a placeholder for your AddRatingForm component.</p>\r\n    <div className=\"flex gap-2\">\r\n      <Button onClick={onRatingAdded}>Submit Rating (Placeholder)</Button>\r\n      <Button variant=\"outline\" onClick={onCancel}>Cancel</Button>\r\n    </div>\r\n  </div>\r\n);\r\n\r\ninterface AddClipFormProps {\r\n  gameId?: string;\r\n  onClipAdded: () => void;\r\n  onCancel: () => void;\r\n}\r\nconst AddClipForm = ({ gameId, onClipAdded, onCancel }: AddClipFormProps) => (\r\n  <div className=\"p-6 border rounded-lg space-y-4\">\r\n    <h2 className=\"text-2xl font-bold\">Add New Clip {gameId && `for Game ID: ${gameId}`}</h2>\r\n    <p className=\"text-muted-foreground\">This is a placeholder for your AddClipForm component.</p>\r\n    <div className=\"flex gap-2\">\r\n      <Button onClick={onClipAdded}>Submit Clip (Placeholder)</Button>\r\n      <Button variant=\"outline\" onClick={onCancel}>Cancel</Button>\r\n    </div>\r\n  </div>\r\n);\r\n// ---------------------------------------------------\r\n\r\n\r\ninterface DashboardProps {\r\n  user: {\r\n    username: string;\r\n    email: string;\r\n    userid: string; // UUID string\r\n    // ðŸ”‘ CHANGE 1: Assume isDev is a mandatory property on the user object\r\n    isDev: boolean;\r\n  }\r\n  onLogout: () => void\r\n}\r\n\r\nexport function Dashboard({ user, onLogout }: DashboardProps) {\r\n  const [view, setView] = useState<\"home\" | \"browse\" | \"add\" | \"characters\" | \"maps\" | \"mobs\" | \"ratings\" | \"add-rating\" | \"account\" | \"clips\" | \"add-clip\">(\"home\")\r\n\r\n  // ðŸ”‘ CHANGE 2: Initialize role to 'viewer'. No need for a separate role loading state.\r\n  const [role, setRole] = useState<\"dev\" | \"editor\" | \"viewer\">(\"viewer\")\r\n\r\n  const [games, setGames] = useState<any[]>([])\r\n  // ... (other data states)\r\n  const [characters, setCharacters] = useState<any[]>([])\r\n  const [maps, setMaps] = useState<any[]>([])\r\n  const [mobs, setMobs] = useState<any[]>([])\r\n  const [ratings, setRatings] = useState<any[]>([])\r\n  const [clips, setClips] = useState<any[]>([])\r\n\r\n  // The state structure for holding the ID\r\n  const [gameIdForRating, setGameIdForRating] = useState<string | null>(null)\r\n  const [gameIdForClip, setGameIdForClip] = useState<string | null>(null)\r\n\r\n  // ... (loading states)\r\n  const [loadingGames, setLoadingGames] = useState(true)\r\n  const [loadingCharacters, setLoadingCharacters] = useState(true)\r\n  const [loadingMaps, setLoadingMaps] = useState(true)\r\n  const [loadingMobs, setLoadingMobs] = useState(true)\r\n  const [loadingRatings, setLoadingRatings] = useState(true)\r\n  const [loadingClips, setLoadingClips] = useState(true)\r\n\r\n  const [menuOpen, setMenuOpen] = useState(false)\r\n\r\n  useEffect(() => {\r\n    // ðŸ”‘ CHANGE 3: Set role immediately based on the user prop, which is already fetched.\r\n    if (user.isDev) {\r\n      setRole(\"dev\")\r\n    } else {\r\n      // You could add logic here to differentiate 'editor' from 'viewer' if needed,\r\n      // but based on the prompt, 'dev' is the only special case for adding games.\r\n      setRole(\"viewer\")\r\n    }\r\n\r\n    fetchGames()\r\n    fetchCharacters()\r\n    fetchMaps()\r\n    fetchMobs()\r\n    fetchRatings()\r\n    fetchClips()\r\n\r\n    // ðŸ”‘ Dependency array now only includes user.isDev and component lifecycle functions\r\n  }, [user.isDev])\r\n\r\n\r\n  // --- (Your existing fetch and handler functions remain the same) ---\r\n  // ...\r\n\r\n  const fetchGames = async () => { /* ... */ setLoadingGames(false); }\r\n  const handleGameAdded = () => { /* ... */ }\r\n  const fetchCharacters = async () => { /* ... */ setLoadingCharacters(false); }\r\n  const handleCharacterAdded = () => { /* ... */ }\r\n  const fetchMobs = async () => { /* ... */ setLoadingMobs(false); }\r\n  const handleMobAdded = () => { /* ... */ }\r\n  const fetchMaps = async () => { /* ... */ setLoadingMaps(false); }\r\n  const handleMapAdded = () => { /* ... */ }\r\n  const fetchRatings = async () => {\r\n    // Fixed the bug in the map function here\r\n    try { /* ... */ } catch (err) { /* ... */ } finally { setLoadingRatings(false); }\r\n  }\r\n  const handleRatingAdded = () => { /* ... */ }\r\n  const handleInitiateAddRating = (gameId: string | undefined) => { setGameIdForRating(gameId || null); setView(\"add-rating\"); }\r\n  const fetchClips = async () => { /* ... */ setLoadingClips(false); }\r\n  const handleClipAdded = () => { /* ... */ }\r\n  const handleInitiateAddClip = (gameId: string | undefined) => { setGameIdForClip(gameId || null); setView(\"add-clip\"); }\r\n\r\n\r\n  const navItems = [\r\n    { id: \"home\", label: \"Dashboard\" },\r\n    { id: \"browse\", label: \"Browse Games\" },\r\n    // Conditional display of \"Add Game\" based on the role state\r\n    ...(role === \"dev\" ? [{ id: \"add\", label: \"Add Game\" }] : []),\r\n    { id: \"ratings\", label: \"Game Ratings\", icon: Star },\r\n    { id: \"clips\", label: \"Clips\" },\r\n    { id: \"characters\", label: \"Characters\" },\r\n    { id: \"maps\", label: \"Maps\" },\r\n    { id: \"mobs\", label: \"Mobs\" },\r\n  ]\r\n\r\n  const displayName = user.username && user.username.length > 0\r\n    ? user.username\r\n    : (user.email ? user.email.split('@')[0] : 'Account');\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background\">\r\n      {/* Header */}\r\n      <header className=\"bg-primary text-primary-foreground border-b-4 border-accent\">\r\n        <div className=\"max-w-7xl mx-auto px-4 py-4 flex justify-between items-center\">\r\n\r\n          <button\r\n            onClick={() => setView(\"home\")}\r\n            className=\"flex items-center gap-2 hover:opacity-80 transition-opacity\"\r\n          >\r\n            <div className=\"text-2xl font-bold\">CRIMSON DB</div>\r\n          </button>\r\n\r\n          <div className=\"flex items-center gap-4\">\r\n\r\n            <button\r\n              onClick={() => { setView(\"account\"); setMenuOpen(false); }}\r\n              className=\"text-sm underline hover:opacity-80 transition-opacity\"\r\n            >\r\n              {displayName} ({role})\r\n            </button>\r\n\r\n            <button onClick={() => setMenuOpen(!menuOpen)} className=\"p-2 hover:bg-primary/80 rounded\">\r\n              {menuOpen ? <X size={24} /> : <Menu size={24} />}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Dropdown Navigation Menu */}\r\n        {menuOpen && (\r\n          <div className=\"bg-primary/95 border-t border-primary-foreground\">\r\n            <div className=\"max-w-7xl mx-auto px-4 py-4\">\r\n              <div className=\"flex flex-col md:flex-row md:items-center md:gap-2 w-full space-y-2 md:space-y-0\">\r\n                {navItems.map((item) => (\r\n                  // The navItems array already handles hiding 'Add Game' based on role\r\n                  <Button\r\n                    key={item.id}\r\n                    onClick={() => {\r\n                      setView(item.id as any)\r\n                      setMenuOpen(false)\r\n                    }}\r\n                    className=\"w-full justify-start md:w-auto md:justify-center\"\r\n                    variant={view === item.id ? \"default\" : \"outline\"}\r\n                  >\r\n                    {item.label}\r\n                  </Button>\r\n                ))}\r\n\r\n                <Button\r\n                  onClick={onLogout}\r\n                  className=\"w-full justify-start bg-transparent md:w-auto md:justify-center md:ml-auto\"\r\n                  variant=\"outline\"\r\n                >\r\n                  Logout\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </header>\r\n\r\n      {/* Main Content */}\r\n      <main className=\"max-w-7xl mx-auto p-4\">\r\n        {view === \"account\" && <AccountDetails user={user} onBack={() => setView(\"home\")} />}\r\n\r\n        {/* Pass the derived role state to DashboardHome */}\r\n        {view === \"home\" && <DashboardHome games={games} characters={characters} maps={maps} mobs={mobs} onNavigate={setView} userRole={role} />}\r\n\r\n        {view === \"browse\" && <GamesGallery games={games} loading={loadingGames} onRefresh={fetchGames} />}\r\n\r\n        {/* Conditional Rendering: Only render AddGameForm if role is 'dev' */}\r\n        {view === \"add\" && role === \"dev\" && <AddGameForm onGameAdded={handleGameAdded} />}\r\n        {view === \"add\" && role !== \"dev\" && (\r\n          <div className=\"text-center p-10 text-xl text-red-500\">Permission Denied: Only developers can add new games.</div>\r\n        )}\r\n\r\n        {view === \"ratings\" && <RatingsBrowser ratings={ratings} loading={loadingRatings} onRefresh={fetchRatings} onAddRating={() => handleInitiateAddRating(undefined)} />}\r\n        {view === \"add-rating\" && (\r\n          <AddRatingForm\r\n            gameId={gameIdForRating || undefined}\r\n            onRatingAdded={handleRatingAdded}\r\n            onCancel={() => setView(\"ratings\")}\r\n          />\r\n        )}\r\n\r\n        {view === \"characters\" && <CharacterBrowser characters={characters} loading={loadingCharacters} onRefresh={fetchCharacters} onCharacterAdded={handleCharacterAdded} />}\r\n        {view === \"maps\" && <MapBrowser maps={maps} loading={loadingMaps} onRefresh={fetchMaps} onMapAdded={handleMapAdded} />}\r\n        {view === \"mobs\" && <MobBrowser mobs={mobs} loading={loadingMobs} onRefresh={fetchMobs} onMobAdded={handleMobAdded} />}\r\n\r\n        {view === \"clips\" && <ClipBrowser clips={clips} loading={loadingClips} onRefresh={fetchClips} onAddClip={() => handleInitiateAddClip(undefined)} />}\r\n        {view === \"add-clip\" && (\r\n          <AddClipForm\r\n            gameId={gameIdForClip || undefined}\r\n            onClipAdded={handleClipAdded}\r\n            onCancel={() => setView(\"clips\")}\r\n          />\r\n        )}\r\n      </main>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4850, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/app/page.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useEffect, useState } from \"react\"\r\nimport { createClient } from \"@/lib/supabase/client\"\r\nimport { AuthForm } from \"@/components/auth-form\"\r\nimport { Dashboard } from \"@/components/dashboard\"\r\n\r\n// Define the required User type\r\ninterface User {\r\n  email: string\r\n  username: string\r\n  // Add the missing 'userid' property\r\n  userid: string \r\n}\r\n\r\nexport default function Home() {\r\n  // Use the new User type\r\n  const [user, setUser] = useState<User | null>(null)\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n\r\n  useEffect(() => {\r\n    const supabase = createClient()\r\n\r\n    if (!supabase) {\r\n      setError(\r\n        \"Supabase not configured. Please add NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY to your environment variables.\",\r\n      )\r\n      setLoading(false)\r\n      return\r\n    }\r\n\r\n    const checkUser = async () => {\r\n      try {\r\n        const {\r\n          data: { user: supabaseUser },\r\n        } = await supabase.auth.getUser()\r\n\r\n        if (supabaseUser) {\r\n          setUser({\r\n            email: supabaseUser.email || \"\",\r\n            username: supabaseUser.user_metadata?.display_name || supabaseUser.email?.split(\"@\")[0] || \"User\",\r\n            // Make sure to include the userid (which is the Supabase user's ID)\r\n            userid: supabaseUser.id, \r\n          })\r\n        }\r\n      } catch (error) {\r\n        console.error(\"[v0] Error checking user:\", error)\r\n      } finally {\r\n        setLoading(false)\r\n      }\r\n    }\r\n\r\n    checkUser()\r\n\r\n    const {\r\n      data: { subscription },\r\n    } = supabase.auth.onAuthStateChange(async (_event, session) => {\r\n      if (session?.user) {\r\n        setUser({\r\n          email: session.user.email || \"\",\r\n          username: session.user.user_metadata?.display_name || session.user.email?.split(\"@\")[0] || \"User\",\r\n          // Include the userid from the session\r\n          userid: session.user.id,\r\n        })\r\n      } else {\r\n        setUser(null)\r\n      }\r\n    })\r\n\r\n    return () => {\r\n      subscription?.unsubscribe()\r\n    }\r\n  }, [])\r\n\r\n  const handleLogout = async () => {\r\n    const supabase = createClient()\r\n    if (supabase) {\r\n      await supabase.auth.signOut()\r\n    }\r\n    setUser(null)\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <main className=\"min-h-screen bg-background flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-4 border-primary border-t-accent mx-auto mb-4\"></div>\r\n          <p className=\"text-muted-foreground\">Loading...</p>\r\n        </div>\r\n      </main>\r\n    )\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <main className=\"min-h-screen bg-background flex items-center justify-center\">\r\n        <div className=\"bg-red-900/20 border border-red-500 rounded-lg p-6 max-w-md\">\r\n          <h1 className=\"text-red-500 font-bold mb-2\">Configuration Error</h1>\r\n          <p className=\"text-white text-sm\">{error}</p>\r\n          <p className=\"text-muted-foreground text-xs mt-4\">\r\n            Check your Vercel project's environment variables in the \"Vars\" section of the Connect sidebar.\r\n          </p>\r\n        </div>\r\n      </main>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <main className=\"min-h-screen bg-background\">\r\n      {user ? (\r\n        <Dashboard user={user} onLogout={handleLogout} />\r\n      ) : (\r\n        <AuthForm\r\n            onLoginSuccess={(userData) => {\r\n              // Assuming userData from AuthForm has an 'id' or 'userid' field\r\n              // You might need to adjust this logic based on what AuthForm actually returns\r\n              const userObject = userData as { email: string; id: string; username?: string };\r\n              setUser({\r\n                email: userObject.email,\r\n                username: userObject.username ?? userObject.email.split(\"@\")[0] ?? \"User\",\r\n                // Assuming the user ID is returned as 'id'\r\n                userid: userObject.id, \r\n              })\r\n            }}\r\n          />\r\n      )}\r\n    </main>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;;;AALA;;;;;AAee,SAAS;;IACtB,wBAAwB;IACxB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAc;IAC9C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAElD,IAAA,0KAAS;0BAAC;YACR,MAAM,WAAW,IAAA,4IAAY;YAE7B,IAAI,CAAC,UAAU;gBACb,SACE;gBAEF,WAAW;gBACX;YACF;YAEA,MAAM;4CAAY;oBAChB,IAAI;wBACF,MAAM,EACJ,MAAM,EAAE,MAAM,YAAY,EAAE,EAC7B,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;wBAE/B,IAAI,cAAc;4BAChB,QAAQ;gCACN,OAAO,aAAa,KAAK,IAAI;gCAC7B,UAAU,aAAa,aAAa,EAAE,gBAAgB,aAAa,KAAK,EAAE,MAAM,IAAI,CAAC,EAAE,IAAI;gCAC3F,oEAAoE;gCACpE,QAAQ,aAAa,EAAE;4BACzB;wBACF;oBACF,EAAE,OAAO,OAAO;wBACd,QAAQ,KAAK,CAAC,6BAA6B;oBAC7C,SAAU;wBACR,WAAW;oBACb;gBACF;;YAEA;YAEA,MAAM,EACJ,MAAM,EAAE,YAAY,EAAE,EACvB,GAAG,SAAS,IAAI,CAAC,iBAAiB;kCAAC,OAAO,QAAQ;oBACjD,IAAI,SAAS,MAAM;wBACjB,QAAQ;4BACN,OAAO,QAAQ,IAAI,CAAC,KAAK,IAAI;4BAC7B,UAAU,QAAQ,IAAI,CAAC,aAAa,EAAE,gBAAgB,QAAQ,IAAI,CAAC,KAAK,EAAE,MAAM,IAAI,CAAC,EAAE,IAAI;4BAC3F,sCAAsC;4BACtC,QAAQ,QAAQ,IAAI,CAAC,EAAE;wBACzB;oBACF,OAAO;wBACL,QAAQ;oBACV;gBACF;;YAEA;kCAAO;oBACL,cAAc;gBAChB;;QACF;yBAAG,EAAE;IAEL,MAAM,eAAe;QACnB,MAAM,WAAW,IAAA,4IAAY;QAC7B,IAAI,UAAU;YACZ,MAAM,SAAS,IAAI,CAAC,OAAO;QAC7B;QACA,QAAQ;IACV;IAEA,IAAI,SAAS;QACX,qBACE,6LAAC;YAAK,WAAU;sBACd,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;;;;;kCACf,6LAAC;wBAAE,WAAU;kCAAwB;;;;;;;;;;;;;;;;;IAI7C;IAEA,IAAI,OAAO;QACT,qBACE,6LAAC;YAAK,WAAU;sBACd,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAG,WAAU;kCAA8B;;;;;;kCAC5C,6LAAC;wBAAE,WAAU;kCAAsB;;;;;;kCACnC,6LAAC;wBAAE,WAAU;kCAAqC;;;;;;;;;;;;;;;;;IAM1D;IAEA,qBACE,6LAAC;QAAK,WAAU;kBACb,qBACC,6LAAC,wIAAS;YAAC,MAAM;YAAM,UAAU;;;;;iCAEjC,6LAAC,0IAAQ;YACL,gBAAgB,CAAC;gBACf,gEAAgE;gBAChE,8EAA8E;gBAC9E,MAAM,aAAa;gBACnB,QAAQ;oBACN,OAAO,WAAW,KAAK;oBACvB,UAAU,WAAW,QAAQ,IAAI,WAAW,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,IAAI;oBACnE,2CAA2C;oBAC3C,QAAQ,WAAW,EAAE;gBACvB;YACF;;;;;;;;;;;AAKZ;GAlHwB;KAAA"}}]
}