{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/lib/supabase/server.ts"],"sourcesContent":["import { createClient as createSupabaseClient } from \"@supabase/supabase-js\"\r\n\r\nexport async function createClient() {\r\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\r\n  const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY\r\n\r\n  if (!supabaseUrl || !supabaseServiceKey) {\r\n    const anonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\r\n    if (!supabaseUrl || !anonKey) {\r\n      throw new Error(\"Missing Supabase URL and keys\")\r\n    }\r\n    return createSupabaseClient(supabaseUrl, anonKey)\r\n  }\r\n\r\n  return createSupabaseClient(supabaseUrl, supabaseServiceKey)\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe;IACpB,MAAM;IACN,MAAM,qBAAqB,QAAQ,GAAG,CAAC,yBAAyB;IAEhE,IAAI,CAAC,eAAe,CAAC,oBAAoB;QACvC,MAAM;QACN;;QAGA,OAAO,IAAA,yMAAoB,EAAC,aAAa;IAC3C;IAEA,OAAO,IAAA,yMAAoB,EAAC,aAAa;AAC3C"}},
    {"offset": {"line": 67, "column": 0}, "map": {"version":3,"sources":["file:///D:/the-crimson-archive/app/api/account/route.ts"],"sourcesContent":["import { createClient } from \"@/lib/supabase/server\"\r\nimport { type NextRequest, NextResponse } from \"next/server\"\r\n\r\n// Define the expected structure of the user profile from the database\r\ninterface UserProfile {\r\n    userID: string;\r\n    username: string;\r\n    email: string;\r\n    pfpURL: string;\r\n    isDev: boolean;\r\n    accountCreationDate: string;\r\n}\r\n\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const supabase = createClient()\r\n\r\n        // 1. Get the current authenticated user's session\r\n        const { data: { user }, error: authError } = await supabase.auth.getUser()\r\n\r\n        if (authError || !user) {\r\n            // User is not logged in or session is invalid\r\n            return NextResponse.json({ error: 'Unauthorized: User not authenticated.' }, { status: 401 })\r\n        }\r\n\r\n        // 2. Fetch the detailed user profile from your custom \"Users\" table\r\n        // We use the UUID from the authenticated user object (user.id)\r\n        const { data: profile, error: profileError } = await supabase\r\n            .from('Users')\r\n            .select('*')\r\n            .eq('userID', user.id) // Query based on the linked UUID\r\n            .returns<UserProfile>() // Specify the expected return type\r\n            .single() // Expect only one result\r\n\r\n        if (profileError || !profile) {\r\n            console.error(\"Profile fetch error:\", profileError?.message);\r\n            return NextResponse.json({ error: 'Profile not found in database.' }, { status: 404 })\r\n        }\r\n\r\n        // 3. Return the detailed profile data\r\n        return NextResponse.json(profile, { status: 200 })\r\n        \r\n    } catch (error) {\r\n        console.error(\"Internal API Error:\", error);\r\n        return NextResponse.json({ error: \"Internal server error\" }, { status: 500 })\r\n    }\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAYO,eAAe,IAAI,OAAoB;IAC1C,IAAI;QACA,MAAM,WAAW,IAAA,2IAAY;QAE7B,kDAAkD;QAClD,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;QAExE,IAAI,aAAa,CAAC,MAAM;YACpB,8CAA8C;YAC9C,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAwC,GAAG;gBAAE,QAAQ;YAAI;QAC/F;QAEA,oEAAoE;QACpE,+DAA+D;QAC/D,MAAM,EAAE,MAAM,OAAO,EAAE,OAAO,YAAY,EAAE,GAAG,MAAM,SAChD,IAAI,CAAC,SACL,MAAM,CAAC,KACP,EAAE,CAAC,UAAU,KAAK,EAAE,EAAE,iCAAiC;SACvD,OAAO,GAAgB,mCAAmC;SAC1D,MAAM,GAAG,yBAAyB;;QAEvC,IAAI,gBAAgB,CAAC,SAAS;YAC1B,QAAQ,KAAK,CAAC,wBAAwB,cAAc;YACpD,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAiC,GAAG;gBAAE,QAAQ;YAAI;QACxF;QAEA,sCAAsC;QACtC,OAAO,gJAAY,CAAC,IAAI,CAAC,SAAS;YAAE,QAAQ;QAAI;IAEpD,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC/E;AACJ"}}]
}