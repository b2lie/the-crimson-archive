module.exports = [
"[project]/node_modules/next-video/dist/video-handler.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "HANDLERS",
    ()=>HANDLERS,
    "callHandler",
    ()=>callHandler,
    "videoHandler",
    ()=>videoHandler
]);
const HANDLERS = {};
const DEFAULT_HANDLER_CONFIG = {
    provider: "mux"
};
async function callHandler(event, data, config = {}) {
    const mergedConfig = {
        ...DEFAULT_HANDLER_CONFIG,
        ...config
    };
    const handler = HANDLERS[event];
    if (!handler) {
        return;
    }
    return handler(data, mergedConfig);
}
function videoHandler(event, callback) {
    HANDLERS[event] = callback;
    return async (event2)=>callback(event2);
}
;
}),
"[project]/node_modules/next-video/dist/config.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getVideoConfig",
    ()=>getVideoConfig,
    "setVideoConfig",
    ()=>setVideoConfig,
    "videoConfigDefault",
    ()=>videoConfigDefault
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$path__$5b$external$5d$__$28$node$3a$path$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:path [external] (node:path, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs$2f$promises__$5b$external$5d$__$28$node$3a$fs$2f$promises$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:fs/promises [external] (node:fs/promises, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$process__$5b$external$5d$__$28$node$3a$process$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:process [external] (node:process, cjs)");
;
;
;
const videoConfigDefault = {
    folder: "videos",
    path: "/api/video",
    provider: "mux",
    providerConfig: {},
    loadAsset: async function(assetPath) {
        const file = await (0, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs$2f$promises__$5b$external$5d$__$28$node$3a$fs$2f$promises$2c$__cjs$29$__["readFile"])(assetPath);
        const asset = JSON.parse(file.toString());
        return asset;
    },
    saveAsset: async function(assetPath, asset) {
        try {
            await (0, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs$2f$promises__$5b$external$5d$__$28$node$3a$fs$2f$promises$2c$__cjs$29$__["mkdir"])(__TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$path__$5b$external$5d$__$28$node$3a$path$2c$__cjs$29$__["default"].dirname(assetPath), {
                recursive: true
            });
            await (0, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs$2f$promises__$5b$external$5d$__$28$node$3a$fs$2f$promises$2c$__cjs$29$__["writeFile"])(assetPath, JSON.stringify(asset), {
                flag: "wx"
            });
        } catch (err) {
            if (err.code === "EEXIST") {
                return;
            }
            throw err;
        }
    },
    updateAsset: async function(assetPath, asset) {
        await (0, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs$2f$promises__$5b$external$5d$__$28$node$3a$fs$2f$promises$2c$__cjs$29$__["writeFile"])(assetPath, JSON.stringify(asset));
    }
};
globalThis.__nextVideo = {
    configComplete: videoConfigDefault,
    configIsDefined: false
};
function setVideoConfig(videoConfig) {
    globalThis.__nextVideo.configIsDefined = true;
    globalThis.__nextVideo.configComplete = {
        ...videoConfigDefault,
        ...videoConfig
    };
    return globalThis.__nextVideo.configComplete;
}
async function getVideoConfig() {
    if (!globalThis.__nextVideo.configIsDefined) {
        try {
            const nextConfigModule = (await import(/* webpackIgnore: true */ "next/dist/server/config.js")).default;
            const loadNextConfig = nextConfigModule.default ?? nextConfigModule;
            await loadNextConfig("phase-development-server", (0, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$process__$5b$external$5d$__$28$node$3a$process$2c$__cjs$29$__["cwd"])());
        } catch (err) {
            console.error(err);
        }
    }
    return globalThis.__nextVideo.configComplete;
}
;
}),
"[project]/node_modules/next-video/dist/utils/utils.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "camelCase",
    ()=>camelCase,
    "deepMerge",
    ()=>deepMerge,
    "getPackageVersion",
    ()=>getPackageVersion,
    "isObject",
    ()=>isObject,
    "isRemote",
    ()=>isRemote,
    "sleep",
    ()=>sleep,
    "toSafePath",
    ()=>toSafePath
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs__$5b$external$5d$__$28$node$3a$fs$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:fs [external] (node:fs, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$resolve$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/resolve/index.js [app-route] (ecmascript)");
;
;
function getPackageVersion(packageName) {
    const packageJsonPath = resolvePackageJson(packageName);
    if (packageJsonPath) {
        try {
            const packageJson = JSON.parse(__TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs__$5b$external$5d$__$28$node$3a$fs$2c$__cjs$29$__["default"].readFileSync(packageJsonPath, {
                encoding: "utf-8"
            }));
            return packageJson.version;
        } catch  {}
    }
    return void 0;
}
function resolvePackageJson(packageName) {
    try {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$resolve$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].sync(`${packageName}/package.json`, {
            basedir: process.cwd(),
            preserveSymlinks: true
        });
    } catch  {
        return void 0;
    }
}
function sleep(ms) {
    return new Promise((resolve2)=>setTimeout(resolve2, ms));
}
function camelCase(name) {
    return name.replace(/[-_]([a-z])/g, ($0, $1)=>$1.toUpperCase());
}
function isRemote(filePath) {
    return /^https?:\/\//.test(filePath);
}
function toSafePath(str) {
    return str.replace(/^[^a-zA-Z0-9]+|[^a-zA-Z0-9]+$/g, "").replace(/[^a-zA-Z0-9._-]+/g, "_");
}
function deepMerge(...objects) {
    const result = {};
    for (const obj of objects){
        for(const key in obj){
            const existing = result[key];
            const val = obj[key];
            if (Array.isArray(val) && Array.isArray(existing)) {
                result[key] = existing.concat(...val);
            } else if (isObject(val) && isObject(existing)) {
                result[key] = deepMerge(existing, val);
            } else {
                result[key] = val;
            }
        }
    }
    return result;
}
function isObject(item) {
    return item && typeof item === "object" && !Array.isArray(item);
}
;
}),
"[project]/node_modules/next-video/dist/providers/mux/transformer.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getPlaybackId",
    ()=>getPlaybackId,
    "getPosterURLFromPlaybackId",
    ()=>getPosterURLFromPlaybackId,
    "transform",
    ()=>transform
]);
const MUX_VIDEO_DOMAIN = "mux.com";
function transform(asset, props) {
    const playbackId = getPlaybackId(asset);
    if (!playbackId) return asset;
    const thumbnailTime = asset.providerMetadata?.mux?.thumbnailTime ?? props?.thumbnailTime ?? props?.startTime;
    const transformedAsset = {
        ...asset,
        sources: [
            {
                src: `https://stream.${props?.customDomain ?? MUX_VIDEO_DOMAIN}/${playbackId}.m3u8`,
                type: "application/x-mpegURL"
            }
        ],
        poster: getPosterURLFromPlaybackId(playbackId, {
            thumbnailTime,
            customDomain: props?.customDomain,
            token: props?.tokens?.thumbnail
        })
    };
    if (thumbnailTime >= 0) {
        transformedAsset.thumbnailTime = thumbnailTime;
    }
    return transformedAsset;
}
function getPlaybackId(asset) {
    const providerMetadata = asset.providerMetadata?.mux ?? asset.externalIds;
    return providerMetadata?.playbackId;
}
const getPosterURLFromPlaybackId = (playbackId, { token, thumbnailTime, width, customDomain = MUX_VIDEO_DOMAIN } = {})=>{
    const time = token == null ? thumbnailTime : void 0;
    const { aud } = parseJwt(token);
    if (token && aud !== "t") {
        return;
    }
    return `https://image.${customDomain}/${playbackId}/thumbnail.webp${toQuery({
        token,
        time,
        width
    })}`;
};
function toQuery(obj) {
    const params = toParams(obj).toString();
    return params ? "?" + params : "";
}
function toParams(obj) {
    const params = {};
    for(const key in obj){
        if (obj[key] != null) params[key] = obj[key];
    }
    return new URLSearchParams(params);
}
function parseJwt(token) {
    const base64Url = (token ?? "").split(".")[1];
    if (!base64Url) return {};
    const base64 = base64Url.replace(/-/g, "+").replace(/_/g, "/");
    const jsonPayload = decodeURIComponent(atob(base64).split("").map(function(c) {
        return "%" + ("00" + c.charCodeAt(0).toString(16)).slice(-2);
    }).join(""));
    return JSON.parse(jsonPayload);
}
;
}),
"[project]/node_modules/next-video/dist/providers/vercel-blob/transformer.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "transform",
    ()=>transform
]);
function transform(asset) {
    const providerDetails = asset.providerMetadata?.["vercel-blob"] ?? asset.externalIds;
    if (!providerDetails) return asset;
    const source = {
        src: providerDetails.url
    };
    if (providerDetails.contentType) {
        source.type = providerDetails.contentType;
    }
    return {
        ...asset,
        sources: [
            source
        ]
    };
}
;
}),
"[project]/node_modules/next-video/dist/providers/backblaze/transformer.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "transform",
    ()=>transform
]);
function transform(asset) {
    const providerMetadata = asset.providerMetadata?.backblaze;
    if (!providerMetadata) return asset;
    const src = new URL(providerMetadata.endpoint);
    src.hostname = `${providerMetadata.bucket}.${src.hostname}`;
    src.pathname = providerMetadata.key;
    const source = {
        src: `${src}`
    };
    return {
        ...asset,
        sources: [
            source
        ]
    };
}
;
}),
"[project]/node_modules/next-video/dist/providers/amazon-s3/transformer.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "transform",
    ()=>transform
]);
function transform(asset) {
    const providerMetadata = asset.providerMetadata?.["amazon-s3"];
    if (!providerMetadata) return asset;
    const src = new URL(providerMetadata.endpoint);
    src.hostname = `${providerMetadata.bucket}.${src.hostname}`;
    src.pathname = providerMetadata.key;
    const source = {
        src: `${src}`
    };
    return {
        ...asset,
        sources: [
            source
        ]
    };
}
;
}),
"[project]/node_modules/next-video/dist/providers/cloudflare-r2/transformer.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "transform",
    ()=>transform
]);
function transform(asset) {
    const providerMetadata = asset.providerMetadata?.["cloudflare-r2"];
    if (!providerMetadata) return asset;
    const src = new URL(providerMetadata.bucketUrlPublic);
    src.pathname = providerMetadata.key;
    const source = {
        src: `${src}`
    };
    return {
        ...asset,
        sources: [
            source
        ]
    };
}
;
}),
"[project]/node_modules/next-video/dist/providers/transformers.js [app-route] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$mux$2f$transformer$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/mux/transformer.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$vercel$2d$blob$2f$transformer$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/vercel-blob/transformer.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$backblaze$2f$transformer$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/backblaze/transformer.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$amazon$2d$s3$2f$transformer$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/amazon-s3/transformer.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$cloudflare$2d$r2$2f$transformer$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/cloudflare-r2/transformer.js [app-route] (ecmascript)");
;
;
;
;
;
;
}),
"[project]/node_modules/next-video/dist/providers/transformers.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "amazonS3",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$amazon$2d$s3$2f$transformer$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__,
    "backblaze",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$backblaze$2f$transformer$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__,
    "cloudflareR2",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$cloudflare$2d$r2$2f$transformer$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__,
    "mux",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$mux$2f$transformer$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__,
    "vercelBlob",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$vercel$2d$blob$2f$transformer$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$transformers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/transformers.js [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$mux$2f$transformer$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/mux/transformer.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$vercel$2d$blob$2f$transformer$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/vercel-blob/transformer.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$backblaze$2f$transformer$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/backblaze/transformer.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$amazon$2d$s3$2f$transformer$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/amazon-s3/transformer.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$cloudflare$2d$r2$2f$transformer$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/cloudflare-r2/transformer.js [app-route] (ecmascript)");
}),
"[project]/node_modules/next-video/dist/assets.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "createAsset",
    ()=>createAsset,
    "getAsset",
    ()=>getAsset,
    "getAssetConfigPath",
    ()=>getAssetConfigPath,
    "updateAsset",
    ()=>updateAsset
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$path__$5b$external$5d$__$28$node$3a$path$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:path [external] (node:path, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$process__$5b$external$5d$__$28$node$3a$process$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:process [external] (node:process, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs$2f$promises__$5b$external$5d$__$28$node$3a$fs$2f$promises$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:fs/promises [external] (node:fs/promises, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/config.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/utils.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$transformers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/transformers.js [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$transformers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/transformers.js [app-route] (ecmascript)");
;
;
;
;
;
;
async function getAsset(filePath) {
    const videoConfig = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getVideoConfig"])();
    const assetConfigPath = await getAssetConfigPath(filePath);
    return videoConfig.loadAsset(assetConfigPath);
}
async function getAssetConfigPath(filePath) {
    return `${await getAssetPath(filePath)}.json`;
}
async function getAssetPath(filePath) {
    if (!(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isRemote"])(filePath)) return filePath;
    const { folder, remoteSourceAssetPath = defaultRemoteSourceAssetPath } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getVideoConfig"])();
    if (!folder) throw new Error("Missing video `folder` config.");
    return __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$path__$5b$external$5d$__$28$node$3a$path$2c$__cjs$29$__["join"](folder, remoteSourceAssetPath(filePath));
}
function defaultRemoteSourceAssetPath(url) {
    const urlObj = new URL(url);
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["toSafePath"])(decodeURIComponent(`${urlObj.hostname}${urlObj.pathname}`));
}
async function createAsset(filePath, assetDetails) {
    const videoConfig = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getVideoConfig"])();
    const assetConfigPath = await getAssetConfigPath(filePath);
    let originalFilePath = filePath;
    if (!(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isRemote"])(filePath)) {
        originalFilePath = __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$path__$5b$external$5d$__$28$node$3a$path$2c$__cjs$29$__["relative"]((0, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$process__$5b$external$5d$__$28$node$3a$process$2c$__cjs$29$__["cwd"])(), filePath);
    }
    const newAssetDetails = {
        status: "pending",
        // overwritable
        ...assetDetails,
        originalFilePath,
        provider: videoConfig.provider,
        providerMetadata: {},
        createdAt: Date.now(),
        updatedAt: Date.now()
    };
    if (!(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isRemote"])(filePath)) {
        try {
            newAssetDetails.size = (await (0, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs$2f$promises__$5b$external$5d$__$28$node$3a$fs$2f$promises$2c$__cjs$29$__["stat"])(filePath))?.size;
        } catch  {}
    }
    await videoConfig.saveAsset(assetConfigPath, newAssetDetails);
    return newAssetDetails;
}
async function updateAsset(filePath, assetDetails) {
    const videoConfig = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getVideoConfig"])();
    const assetConfigPath = await getAssetConfigPath(filePath);
    const currentAsset = await getAsset(filePath);
    if (!currentAsset) {
        throw new Error(`Asset not found: ${filePath}`);
    }
    let newAssetDetails = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["deepMerge"])(currentAsset, assetDetails, {
        updatedAt: Date.now()
    });
    newAssetDetails = transformAsset(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$transformers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__, newAssetDetails);
    await videoConfig.updateAsset(assetConfigPath, newAssetDetails);
    return newAssetDetails;
}
function transformAsset(transformers2, asset) {
    const provider = asset.provider;
    if (!provider) return asset;
    for (let [key, transformer] of Object.entries(transformers2)){
        if (key === (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["camelCase"])(provider)) {
            return transformer.transform(asset);
        }
    }
    return asset;
}
;
}),
"[project]/node_modules/next-video/dist/utils/logger.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "add",
    ()=>add,
    "base",
    ()=>base,
    "default",
    ()=>logger_default,
    "error",
    ()=>error,
    "info",
    ()=>info,
    "label",
    ()=>label,
    "log",
    ()=>log,
    "space",
    ()=>space,
    "success",
    ()=>success,
    "warning",
    ()=>warning
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/chalk/source/index.js [app-route] (ecmascript)");
;
function base(type, ...messages) {
    console[type](...messages);
}
function log(...messages) {
    base("log", ...messages);
}
function info(...messages) {
    base("log", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].blue.bold("-"), ...messages);
}
function success(...messages) {
    base("log", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].green.bold("\u2713"), ...messages);
}
function add(...messages) {
    base("log", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].blue.green("+"), ...messages);
}
function warning(...messages) {
    base("log", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].yellow.bold("\u26A0"), ...messages);
}
function error(...messages) {
    base("error", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].red.bold("\u2717"), ...messages);
    base("log", "");
}
function space(...messages) {
    base("log", " ", ...messages);
}
function label(detail) {
    return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].magenta.bold(detail);
}
var logger_default = {
    base,
    log,
    info,
    success,
    add,
    warning,
    error,
    space,
    label
};
;
}),
"[project]/node_modules/next-video/dist/utils/queue.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Queue",
    ()=>Queue
]);
class Queue {
    constructor(delayMs = 1e3){
        this.lastRequestTime = null;
        this.requestQueue = [];
        this.processing = false;
        this.delayMs = delayMs;
    }
    async enqueue(fn) {
        return new Promise((resolve, reject)=>{
            this.requestQueue.push({
                fn,
                resolve,
                reject
            });
            if (!this.processing) {
                this.processNext();
            }
        });
    }
    processNext() {
        if (this.requestQueue.length === 0) {
            this.processing = false;
            return;
        }
        this.processing = true;
        if (this.lastRequestTime !== null) {
            const elapsed = Date.now() - this.lastRequestTime;
            const waitTime = this.delayMs - elapsed;
            if (waitTime > 0) {
                setTimeout(()=>this.executeNextRequest(), waitTime);
            } else {
                this.executeNextRequest();
            }
        } else {
            this.executeNextRequest();
        }
    }
    executeNextRequest() {
        const item = this.requestQueue.shift();
        if (!item) {
            this.processing = false;
            return;
        }
        const { fn, resolve, reject } = item;
        fn().then((result)=>{
            resolve(result);
        }).catch((err)=>{
            reject(err);
        }).finally(()=>{
            this.lastRequestTime = Date.now();
            this.processNext();
        });
    }
}
;
}),
"[project]/node_modules/next-video/dist/providers/mux/provider.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "createThumbHash",
    ()=>createThumbHash,
    "uploadLocalFile",
    ()=>uploadLocalFile,
    "uploadRequestedFile",
    ()=>uploadRequestedFile,
    "validateNewAssetSettings",
    ()=>validateNewAssetSettings
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs__$5b$external$5d$__$28$node$3a$fs$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:fs [external] (node:fs, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs$2f$promises__$5b$external$5d$__$28$node$3a$fs$2f$promises$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:fs/promises [external] (node:fs/promises, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/chalk/source/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$mux$2f$mux$2d$node$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@mux/mux-node/index.mjs [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$undici$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/undici/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$minimatch$2f$dist$2f$esm$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/minimatch/dist/esm/index.js [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/assets.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/config.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/logger.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/utils.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$queue$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/queue.js [app-route] (ecmascript)");
;
;
;
;
;
;
;
;
;
;
;
function validateNewAssetSettings(newAssetSettings) {
    const errors = [];
    if (!newAssetSettings || typeof newAssetSettings !== "object") {
        errors.push("newAssetSettings must be an object");
        return {
            valid: false,
            errors
        };
    }
    if (newAssetSettings.maxResolutionTier !== void 0) {
        const validResolutions = [
            "1080p",
            "1440p",
            "2160p"
        ];
        if (!validResolutions.includes(newAssetSettings.maxResolutionTier)) {
            errors.push(`maxResolutionTier must be one of: ${validResolutions.join(", ")}`);
        }
    }
    if (newAssetSettings.videoQuality !== void 0) {
        const validQualities = [
            "basic",
            "plus",
            "premium"
        ];
        if (!validQualities.includes(newAssetSettings.videoQuality)) {
            errors.push(`videoQuality must be one of: ${validQualities.join(", ")}`);
        }
    }
    const validProperties = [
        "maxResolutionTier",
        "videoQuality"
    ];
    const unknownProperties = Object.keys(newAssetSettings).filter((key)=>!validProperties.includes(key));
    if (unknownProperties.length > 0) {
        errors.push(`Unknown properties: ${unknownProperties.join(", ")}. Valid properties: ${validProperties.join(", ")}`);
    }
    return {
        valid: errors.length === 0,
        errors
    };
}
function getNewAssetSettings(filePath, muxConfig) {
    try {
        if (!filePath) {
            return void 0;
        }
        const normalizedFilePath = filePath.replace(/\\/g, "/");
        if (muxConfig?.newAssetSettings?.[filePath] || muxConfig?.newAssetSettings?.[normalizedFilePath]) {
            const newAssetSettings = muxConfig.newAssetSettings[filePath] || muxConfig.newAssetSettings[normalizedFilePath];
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Asset settings:"), "Using exact path match");
            return newAssetSettings;
        }
        if (muxConfig?.newAssetSettings) {
            for (const [pattern, newAssetSettings] of Object.entries(muxConfig.newAssetSettings)){
                if ((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$minimatch$2f$dist$2f$esm$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__["minimatch"])(normalizedFilePath, pattern)) {
                    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Asset settings:"), "Using pattern match");
                    return newAssetSettings;
                }
            }
        }
        return void 0;
    } catch (e) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("Error retrieving asset settings for file:", filePath);
        return void 0;
    }
}
let mux;
let queue;
function initMux() {
    mux ?? (mux = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$mux$2f$mux$2d$node$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__["default"]());
    queue ?? (queue = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$queue$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Queue"]());
}
async function pollForAssetReady(filePath, asset) {
    const providerMetadata = asset.providerMetadata?.mux;
    if (!providerMetadata?.assetId) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("No assetId provided for asset.");
        console.error(asset);
        return;
    }
    initMux();
    const assetId = providerMetadata?.assetId;
    const muxAsset = await mux.video.assets.retrieve(assetId);
    const playbackId = muxAsset.playback_ids?.[0].id;
    let updatedAsset = asset;
    if (providerMetadata?.playbackId !== playbackId) {
        updatedAsset = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["updateAsset"])(filePath, {
            providerMetadata: {
                mux: {
                    playbackId
                }
            }
        });
    }
    if (muxAsset.status === "errored") {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Asset errored:"), filePath);
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].space(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].gray(">"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Mux Asset ID:"), assetId);
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["updateAsset"])(filePath, {
            status: "error",
            error: muxAsset.errors
        });
    }
    if (muxAsset.status === "ready") {
        let blurDataURL;
        try {
            blurDataURL = await createThumbHash(`https://image.mux.com/${playbackId}/thumbnail.webp?width=16&height=16`);
        } catch (e) {
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("Error creating a thumbnail hash.");
        }
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].success(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Asset is ready:"), filePath);
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].space(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].gray(">"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Playback ID:"), playbackId);
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["updateAsset"])(filePath, {
            status: "ready",
            blurDataURL,
            providerMetadata: {
                mux: {
                    playbackId
                }
            }
        });
    } else {
        await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["sleep"])(1e3);
        return pollForAssetReady(filePath, updatedAsset);
    }
}
async function pollForUploadAsset(filePath, asset) {
    const providerMetadata = asset.providerMetadata?.mux;
    if (!providerMetadata?.uploadId) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("No uploadId provided for asset.");
        console.error(asset);
        return;
    }
    initMux();
    const uploadId = providerMetadata?.uploadId;
    const muxUpload = await mux.video.uploads.retrieve(uploadId);
    if (muxUpload.asset_id) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Asset is processing:"), filePath);
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].space(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].gray(">"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Mux Asset ID:"), muxUpload.asset_id);
        const processingAsset = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["updateAsset"])(filePath, {
            status: "processing",
            providerMetadata: {
                mux: {
                    assetId: muxUpload.asset_id
                }
            }
        });
        return pollForAssetReady(filePath, processingAsset);
    } else {
        await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["sleep"])(1e3);
        return pollForUploadAsset(filePath, asset);
    }
}
async function createUploadURL(filePath) {
    try {
        const { providerConfig } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getVideoConfig"])();
        const muxConfig = providerConfig.mux;
        const newAssetSettings = getNewAssetSettings(filePath, muxConfig);
        const upload = await mux.video.uploads.create({
            cors_origin: "*",
            new_asset_settings: {
                playback_policy: [
                    "public"
                ],
                video_quality: newAssetSettings?.videoQuality || muxConfig?.videoQuality,
                max_resolution_tier: newAssetSettings?.maxResolutionTier
            }
        });
        return upload;
    } catch (e) {
        if (e instanceof Error && "status" in e && e.status === 401) {
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("Unauthorized request. Check that your MUX_TOKEN_ID and MUX_TOKEN_SECRET credentials are valid.");
        } else {
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("Error creating a Mux Direct Upload");
            console.error(e);
        }
        return void 0;
    }
}
async function uploadLocalFile(asset) {
    const filePath = asset.originalFilePath;
    if (!filePath) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("No filePath provided for asset.");
        console.error(asset);
        return;
    }
    initMux();
    if (asset.status === "ready") {
        return;
    } else if (asset.status === "processing") {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Asset is already processing. Polling for completion:"), filePath);
        return pollForAssetReady(filePath, asset);
    } else if (asset.status === "uploading") {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Resuming upload:"), filePath);
    }
    if (filePath && /^https?:\/\//.test(filePath)) {
        return uploadRequestedFile(asset);
    }
    const upload = await queue.enqueue(()=>createUploadURL(filePath));
    if (!upload) {
        return;
    }
    await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["updateAsset"])(filePath, {
        status: "uploading",
        providerMetadata: {
            mux: {
                uploadId: upload.id
            }
        }
    });
    const fileStats = await __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs$2f$promises__$5b$external$5d$__$28$node$3a$fs$2f$promises$2c$__cjs$29$__["default"].stat(filePath);
    const stream = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs__$5b$external$5d$__$28$node$3a$fs$2c$__cjs$29$__["createReadStream"])(filePath);
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Uploading file:"), `${filePath} (${fileStats.size} bytes)`);
    try {
        await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$undici$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["fetch"])(upload.url, {
            method: "PUT",
            // @ts-ignore
            body: stream,
            duplex: "half"
        });
        stream.close();
    } catch (e) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("Error uploading to the Mux upload URL");
        console.error(e);
        return;
    }
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].success(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("File uploaded:"), `${filePath} (${fileStats.size} bytes)`);
    const processingAsset = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["updateAsset"])(filePath, {
        status: "processing"
    });
    return pollForUploadAsset(filePath, processingAsset);
}
async function uploadRequestedFile(asset) {
    const filePath = asset.originalFilePath;
    if (!filePath) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("No URL provided for asset.");
        console.error(asset);
        return;
    }
    initMux();
    if (asset.status === "ready") {
        return;
    } else if (asset.status === "processing") {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Asset is already processing. Polling for completion:"), filePath);
        return pollForAssetReady(filePath, asset);
    }
    const { providerConfig } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getVideoConfig"])();
    const muxConfig = providerConfig.mux;
    const newAssetSettings = getNewAssetSettings(filePath, muxConfig);
    const assetObj = await mux.video.assets.create({
        input: [
            {
                url: filePath
            }
        ],
        playback_policy: [
            "public"
        ],
        video_quality: newAssetSettings?.videoQuality || muxConfig?.videoQuality,
        max_resolution_tier: newAssetSettings?.maxResolutionTier
    });
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Asset is processing:"), filePath);
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].space(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].gray(">"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Mux Asset ID:"), assetObj.id);
    const processingAsset = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["updateAsset"])(filePath, {
        status: "processing",
        providerMetadata: {
            mux: {
                assetId: assetObj.id
            }
        }
    });
    return pollForAssetReady(filePath, processingAsset);
}
async function createThumbHash(imgUrl) {
    const response = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$undici$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["fetch"])(imgUrl);
    const buffer = await response.arrayBuffer();
    const base64String = btoa(String.fromCharCode(...new Uint8Array(buffer)));
    return `data:image/webp;base64,${base64String}`;
}
;
}),
"[project]/node_modules/next-video/dist/utils/provider.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "createAssetKey",
    ()=>createAssetKey
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$path__$5b$external$5d$__$28$node$3a$path$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:path [external] (node:path, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/config.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/utils.js [app-route] (ecmascript)");
;
;
;
async function createAssetKey(filePathOrURL, provider) {
    const { folder, providerConfig } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getVideoConfig"])();
    const config = providerConfig[provider];
    const { generateAssetKey = defaultGenerateAssetKey } = config ?? {};
    return generateAssetKey(filePathOrURL, folder);
}
function defaultGenerateAssetKey(filePathOrURL, folder) {
    if (!(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isRemote"])(filePathOrURL)) return filePathOrURL;
    const url = new URL(filePathOrURL);
    return __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$path__$5b$external$5d$__$28$node$3a$path$2c$__cjs$29$__["posix"].join(folder, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$path__$5b$external$5d$__$28$node$3a$path$2c$__cjs$29$__["basename"](decodeURIComponent(url.pathname)));
}
;
}),
"[project]/node_modules/next-video/dist/providers/vercel-blob/provider.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "config",
    ()=>config,
    "uploadLocalFile",
    ()=>uploadLocalFile,
    "uploadRequestedFile",
    ()=>uploadRequestedFile
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs__$5b$external$5d$__$28$node$3a$fs$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:fs [external] (node:fs, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs$2f$promises__$5b$external$5d$__$28$node$3a$fs$2f$promises$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:fs/promises [external] (node:fs/promises, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$undici$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/undici/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$vercel$2f$blob$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@vercel/blob/dist/index.js [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/chalk/source/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/assets.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/provider.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/utils.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/logger.js [app-route] (ecmascript)");
;
;
;
;
;
;
;
;
;
const config = {
    runtime: "edge"
};
async function uploadLocalFile(asset) {
    const filePath = asset.originalFilePath;
    if (!filePath) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("No filePath provided for asset.");
        console.error(asset);
        return;
    }
    if ((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isRemote"])(filePath)) {
        return uploadRequestedFile(asset);
    }
    if (asset.status === "ready") {
        return;
    } else if (asset.status === "uploading") {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Resuming upload:"), filePath);
    }
    await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["updateAsset"])(filePath, {
        status: "uploading"
    });
    const fileStats = await __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs$2f$promises__$5b$external$5d$__$28$node$3a$fs$2f$promises$2c$__cjs$29$__["default"].stat(filePath);
    const stream = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs__$5b$external$5d$__$28$node$3a$fs$2c$__cjs$29$__["createReadStream"])(filePath);
    return putAsset(filePath, fileStats.size, stream);
}
async function uploadRequestedFile(asset) {
    const filePath = asset.originalFilePath;
    if (!filePath) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("No URL provided for asset.");
        console.error(asset);
        return;
    }
    if (asset.status === "ready") {
        return;
    }
    await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["updateAsset"])(filePath, {
        status: "uploading"
    });
    const response = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$undici$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["fetch"])(filePath);
    const size = Number(response.headers.get("content-length"));
    const stream = response.body;
    if (!stream) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("Error fetching the requested file:", filePath);
        return;
    }
    return putAsset(filePath, size, stream);
}
async function putAsset(filePath, size, stream) {
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Uploading file:"), `${filePath} (${size} bytes)`);
    let key;
    let blob;
    try {
        key = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createAssetKey"])(filePath, "vercel-blob");
        blob = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$vercel$2f$blob$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__["put"])(key, stream, {
            access: "public"
        });
        if (stream instanceof __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs__$5b$external$5d$__$28$node$3a$fs$2c$__cjs$29$__["ReadStream"]) {
            stream.close();
        }
    } catch (e) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("Error uploading to Vercel Blob");
        console.error(e);
        return;
    }
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].success(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("File uploaded:"), `${filePath} (${size} bytes)`);
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].space(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].gray(">"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("URL:"), blob.url);
    const updatedAsset = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["updateAsset"])(filePath, {
        status: "ready",
        providerMetadata: {
            "vercel-blob": {
                key,
                url: blob.url,
                contentType: blob.contentType
            }
        }
    });
    const url = updatedAsset.sources?.[0].src;
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].space(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].gray(">"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("URL:"), url);
    return updatedAsset;
}
;
}),
"[project]/node_modules/next-video/dist/utils/s3.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "createBucket",
    ()=>createBucket,
    "findBucket",
    ()=>findBucket,
    "putBucketAcl",
    ()=>putBucketAcl,
    "putBucketCors",
    ()=>putBucketCors,
    "putObject",
    ()=>putObject
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f40$aws$2d$sdk$2f$client$2d$s3__$5b$external$5d$__$2840$aws$2d$sdk$2f$client$2d$s3$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/@aws-sdk/client-s3 [external] (@aws-sdk/client-s3, cjs)");
;
async function findBucket(s3, callbackFn) {
    const { Buckets } = await s3.send(new __TURBOPACK__imported__module__$5b$externals$5d2f40$aws$2d$sdk$2f$client$2d$s3__$5b$external$5d$__$2840$aws$2d$sdk$2f$client$2d$s3$2c$__cjs$29$__["ListBucketsCommand"]({}));
    return Buckets?.find(callbackFn);
}
function createBucket(s3, bucketName, input) {
    return s3.send(new __TURBOPACK__imported__module__$5b$externals$5d2f40$aws$2d$sdk$2f$client$2d$s3__$5b$external$5d$__$2840$aws$2d$sdk$2f$client$2d$s3$2c$__cjs$29$__["CreateBucketCommand"]({
        Bucket: bucketName,
        ...input
    }));
}
async function putBucketAcl(s3, bucketName, input) {
    await s3.send(new __TURBOPACK__imported__module__$5b$externals$5d2f40$aws$2d$sdk$2f$client$2d$s3__$5b$external$5d$__$2840$aws$2d$sdk$2f$client$2d$s3$2c$__cjs$29$__["DeletePublicAccessBlockCommand"]({
        Bucket: bucketName
    }));
    return s3.send(new __TURBOPACK__imported__module__$5b$externals$5d2f40$aws$2d$sdk$2f$client$2d$s3__$5b$external$5d$__$2840$aws$2d$sdk$2f$client$2d$s3$2c$__cjs$29$__["PutBucketAclCommand"]({
        Bucket: bucketName,
        ACL: input?.ACL ?? "public-read",
        ...input
    }));
}
function putObject(s3, input) {
    return s3.send(new __TURBOPACK__imported__module__$5b$externals$5d2f40$aws$2d$sdk$2f$client$2d$s3__$5b$external$5d$__$2840$aws$2d$sdk$2f$client$2d$s3$2c$__cjs$29$__["PutObjectCommand"](input));
}
function putBucketCors(s3, bucketName) {
    return s3.send(new __TURBOPACK__imported__module__$5b$externals$5d2f40$aws$2d$sdk$2f$client$2d$s3__$5b$external$5d$__$2840$aws$2d$sdk$2f$client$2d$s3$2c$__cjs$29$__["PutBucketCorsCommand"]({
        Bucket: bucketName,
        CORSConfiguration: {
            CORSRules: [
                {
                    // Allow all headers to be sent to this bucket.
                    AllowedHeaders: [
                        "*"
                    ],
                    // Allow only GET and PUT methods to be sent to this bucket.
                    AllowedMethods: [
                        "GET",
                        "PUT"
                    ],
                    // Allow only requests from the specified origin.
                    AllowedOrigins: [
                        "*"
                    ],
                    // Allow the entity tag (ETag) header to be returned in the response. The ETag header
                    // The entity tag represents a specific version of the object. The ETag reflects
                    // changes only to the contents of an object, not its metadata.
                    ExposeHeaders: [
                        "ETag"
                    ],
                    // How long the requesting browser should cache the preflight response. After
                    // this time, the preflight request will have to be made again.
                    MaxAgeSeconds: 3600
                }
            ]
        }
    }));
}
;
}),
"[project]/node_modules/next-video/dist/providers/backblaze/provider.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "uploadLocalFile",
    ()=>uploadLocalFile,
    "uploadRequestedFile",
    ()=>uploadRequestedFile
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs__$5b$external$5d$__$28$node$3a$fs$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:fs [external] (node:fs, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$stream__$5b$external$5d$__$28$node$3a$stream$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:stream [external] (node:stream, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs$2f$promises__$5b$external$5d$__$28$node$3a$fs$2f$promises$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:fs/promises [external] (node:fs/promises, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$process__$5b$external$5d$__$28$node$3a$process$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:process [external] (node:process, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$undici$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/undici/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/chalk/source/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$paralleldrive$2f$cuid2$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@paralleldrive/cuid2/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$externals$5d2f40$aws$2d$sdk$2f$client$2d$s3__$5b$external$5d$__$2840$aws$2d$sdk$2f$client$2d$s3$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/@aws-sdk/client-s3 [external] (@aws-sdk/client-s3, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/assets.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/config.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$s3$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/s3.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/provider.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/utils.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/logger.js [app-route] (ecmascript)");
;
;
;
;
;
;
;
;
;
;
;
;
;
;
const createId = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$paralleldrive$2f$cuid2$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].init({
    length: 11
});
let s3;
let bucketName;
let endpoint;
async function initS3() {
    const { providerConfig } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getVideoConfig"])();
    const backblazeConfig = providerConfig.backblaze;
    bucketName = backblazeConfig?.bucket ?? "";
    endpoint = backblazeConfig?.endpoint ?? "";
    const regionMatch = endpoint.match(/\.([a-z0-9-]+)\.backblazeb2\.com$/);
    const region = regionMatch ? regionMatch[1] : "";
    s3 ?? (s3 = new __TURBOPACK__imported__module__$5b$externals$5d2f40$aws$2d$sdk$2f$client$2d$s3__$5b$external$5d$__$2840$aws$2d$sdk$2f$client$2d$s3$2c$__cjs$29$__["S3Client"]({
        endpoint,
        region,
        credentials: {
            accessKeyId: backblazeConfig?.accessKeyId ?? __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$process__$5b$external$5d$__$28$node$3a$process$2c$__cjs$29$__["env"].BACKBLAZE_ACCESS_KEY_ID ?? "",
            secretAccessKey: backblazeConfig?.secretAccessKey ?? __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$process__$5b$external$5d$__$28$node$3a$process$2c$__cjs$29$__["env"].BACKBLAZE_SECRET_ACCESS_KEY ?? ""
        }
    }));
    if (!bucketName) {
        try {
            const bucket = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$s3$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["findBucket"])(s3, (bucket2)=>bucket2.Name?.startsWith("next-videos-"));
            if (bucket) {
                bucketName = bucket.Name;
                __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Using existing Backblaze bucket:"), bucketName);
            }
        } catch (err) {
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("Error listing Backblaze buckets");
            console.error(err);
        }
    }
    if (!bucketName) {
        bucketName = `next-videos-${createId()}`;
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Creating Backblaze bucket:"), bucketName);
        try {
            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$s3$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createBucket"])(s3, bucketName, {
                ACL: "public-read"
            });
            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$s3$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["putBucketCors"])(s3, bucketName);
        } catch (err) {
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("Error creating Backblaze bucket");
            console.error(err);
        }
    }
}
async function uploadLocalFile(asset) {
    const filePath = asset.originalFilePath;
    if (!filePath) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("No filePath provided for asset.");
        console.error(asset);
        return;
    }
    if ((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isRemote"])(filePath)) {
        return uploadRequestedFile(asset);
    }
    if (asset.status === "ready") {
        return;
    } else if (asset.status === "uploading") {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Resuming upload:"), filePath);
    }
    await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["updateAsset"])(filePath, {
        status: "uploading"
    });
    await initS3();
    const fileStats = await __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs$2f$promises__$5b$external$5d$__$28$node$3a$fs$2f$promises$2c$__cjs$29$__["default"].stat(filePath);
    const stream = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs__$5b$external$5d$__$28$node$3a$fs$2c$__cjs$29$__["createReadStream"])(filePath);
    return putAsset(filePath, fileStats.size, stream);
}
async function uploadRequestedFile(asset) {
    const filePath = asset.originalFilePath;
    if (!filePath) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("No URL provided for asset.");
        console.error(asset);
        return;
    }
    if (asset.status === "ready") {
        return;
    }
    await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["updateAsset"])(filePath, {
        status: "uploading"
    });
    await initS3();
    const response = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$undici$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["fetch"])(filePath);
    const size = Number(response.headers.get("content-length"));
    const stream = response.body;
    if (!stream) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("Error fetching the requested file:", filePath);
        return;
    }
    return putAsset(filePath, size, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$stream__$5b$external$5d$__$28$node$3a$stream$2c$__cjs$29$__["Readable"].fromWeb(stream));
}
async function putAsset(filePath, size, stream) {
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Uploading file:"), `${filePath} (${size} bytes)`);
    let key;
    try {
        key = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createAssetKey"])(filePath, "backblaze");
        await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$s3$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["putObject"])(s3, {
            Bucket: bucketName,
            Key: key,
            Body: stream,
            ContentLength: size
        });
        if (stream instanceof __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs__$5b$external$5d$__$28$node$3a$fs$2c$__cjs$29$__["ReadStream"]) {
            stream.close();
        }
    } catch (e) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("Error uploading to Backblaze B2");
        console.error(e);
        return;
    }
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].success(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("File uploaded:"), `${filePath} (${size} bytes)`);
    const updatedAsset = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["updateAsset"])(filePath, {
        status: "ready",
        providerMetadata: {
            backblaze: {
                endpoint,
                bucket: bucketName,
                key
            }
        }
    });
    const url = updatedAsset.sources?.[0].src;
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].space(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].gray(">"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("URL:"), url);
    return updatedAsset;
}
;
}),
"[project]/node_modules/next-video/dist/providers/amazon-s3/provider.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "uploadLocalFile",
    ()=>uploadLocalFile,
    "uploadRequestedFile",
    ()=>uploadRequestedFile
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs__$5b$external$5d$__$28$node$3a$fs$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:fs [external] (node:fs, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$stream__$5b$external$5d$__$28$node$3a$stream$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:stream [external] (node:stream, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs$2f$promises__$5b$external$5d$__$28$node$3a$fs$2f$promises$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:fs/promises [external] (node:fs/promises, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$process__$5b$external$5d$__$28$node$3a$process$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:process [external] (node:process, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$undici$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/undici/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/chalk/source/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$paralleldrive$2f$cuid2$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@paralleldrive/cuid2/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$externals$5d2f40$aws$2d$sdk$2f$client$2d$s3__$5b$external$5d$__$2840$aws$2d$sdk$2f$client$2d$s3$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/@aws-sdk/client-s3 [external] (@aws-sdk/client-s3, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/assets.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/config.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$s3$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/s3.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/provider.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/utils.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/logger.js [app-route] (ecmascript)");
;
;
;
;
;
;
;
;
;
;
;
;
;
;
const createId = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$paralleldrive$2f$cuid2$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].init({
    length: 11
});
let s3;
let bucketName;
let endpoint;
async function initS3() {
    const { providerConfig } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getVideoConfig"])();
    const amazonS3Config = providerConfig["amazon-s3"];
    bucketName = amazonS3Config?.bucket ?? "";
    endpoint = amazonS3Config?.endpoint ?? "";
    const regionMatch = endpoint.match(/\.([a-z0-9-]+)\.amazonaws\.com$/);
    const region = regionMatch ? regionMatch[1] : "";
    s3 ?? (s3 = new __TURBOPACK__imported__module__$5b$externals$5d2f40$aws$2d$sdk$2f$client$2d$s3__$5b$external$5d$__$2840$aws$2d$sdk$2f$client$2d$s3$2c$__cjs$29$__["S3Client"]({
        endpoint,
        region,
        credentials: {
            accessKeyId: amazonS3Config?.accessKeyId ?? __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$process__$5b$external$5d$__$28$node$3a$process$2c$__cjs$29$__["env"].AWS_ACCESS_KEY_ID ?? "",
            secretAccessKey: amazonS3Config?.secretAccessKey ?? __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$process__$5b$external$5d$__$28$node$3a$process$2c$__cjs$29$__["env"].AWS_SECRET_ACCESS_KEY ?? ""
        }
    }));
    if (!bucketName) {
        try {
            const bucket = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$s3$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["findBucket"])(s3, (bucket2)=>bucket2.Name?.startsWith("next-videos-"));
            if (bucket) {
                bucketName = bucket.Name;
                __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Using existing Amazon S3 bucket:"), bucketName);
            }
        } catch (err) {
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("Error listing Amazon S3 buckets");
            console.error(err);
        }
    }
    if (!bucketName) {
        bucketName = `next-videos-${createId()}`;
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Creating Amazon S3 bucket:"), bucketName);
        try {
            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$s3$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createBucket"])(s3, bucketName, {
                // https://aws.amazon.com/blogs/aws/heads-up-amazon-s3-security-changes-are-coming-in-april-of-2023/
                // Can't set ACL here since the security changes, but we can set it after the bucket is created.
                // S3ServiceException [InvalidBucketAclWithBlockPublicAccessError]: Bucket cannot have public ACLs set with BlockPublicAccess enabled
                // ACL: 'public-read',
                // Since the security changes the default ObjectOwnership is BucketOwnerEnforced which doesn't allow ACLs. Change it here.
                // InvalidBucketAclWithObjectOwnership: Bucket cannot have ACLs set with ObjectOwnership's BucketOwnerEnforced setting
                ObjectOwnership: "ObjectWriter"
            });
            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$s3$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["putBucketAcl"])(s3, bucketName);
            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$s3$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["putBucketCors"])(s3, bucketName);
        } catch (err) {
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("Error creating Amazon S3 bucket");
            console.error(err);
        }
    }
}
async function uploadLocalFile(asset) {
    const filePath = asset.originalFilePath;
    if (!filePath) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("No filePath provided for asset.");
        console.error(asset);
        return;
    }
    if ((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isRemote"])(filePath)) {
        return uploadRequestedFile(asset);
    }
    if (asset.status === "ready") {
        return;
    } else if (asset.status === "uploading") {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Resuming upload:"), filePath);
    }
    await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["updateAsset"])(filePath, {
        status: "uploading"
    });
    await initS3();
    const fileStats = await __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs$2f$promises__$5b$external$5d$__$28$node$3a$fs$2f$promises$2c$__cjs$29$__["default"].stat(filePath);
    const stream = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs__$5b$external$5d$__$28$node$3a$fs$2c$__cjs$29$__["createReadStream"])(filePath);
    return putAsset(filePath, fileStats.size, stream);
}
async function uploadRequestedFile(asset) {
    const filePath = asset.originalFilePath;
    if (!filePath) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("No URL provided for asset.");
        console.error(asset);
        return;
    }
    if (asset.status === "ready") {
        return;
    }
    await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["updateAsset"])(filePath, {
        status: "uploading"
    });
    await initS3();
    const response = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$undici$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["fetch"])(filePath);
    const size = Number(response.headers.get("content-length"));
    const stream = response.body;
    if (!stream) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("Error fetching the requested file:", filePath);
        return;
    }
    return putAsset(filePath, size, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$stream__$5b$external$5d$__$28$node$3a$stream$2c$__cjs$29$__["Readable"].fromWeb(stream));
}
async function putAsset(filePath, size, stream) {
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Uploading file:"), `${filePath} (${size} bytes)`);
    let key;
    try {
        key = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createAssetKey"])(filePath, "amazon-s3");
        await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$s3$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["putObject"])(s3, {
            ACL: "public-read",
            Bucket: bucketName,
            Key: key,
            Body: stream,
            ContentLength: size
        });
        if (stream instanceof __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs__$5b$external$5d$__$28$node$3a$fs$2c$__cjs$29$__["ReadStream"]) {
            stream.close();
        }
    } catch (e) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("Error uploading to Amazon S3");
        console.error(e);
        return;
    }
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].success(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("File uploaded:"), `${filePath} (${size} bytes)`);
    const updatedAsset = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["updateAsset"])(filePath, {
        status: "ready",
        providerMetadata: {
            "amazon-s3": {
                endpoint,
                bucket: bucketName,
                key
            }
        }
    });
    const url = updatedAsset.sources?.[0].src;
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].space(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].gray(">"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("URL:"), url);
    return updatedAsset;
}
;
}),
"[project]/node_modules/next-video/dist/utils/r2.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "publicAccessR2Bucket",
    ()=>publicAccessR2Bucket
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$undici$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/undici/index.js [app-route] (ecmascript)");
;
async function publicAccessR2Bucket(accountId, bucketName, apiToken) {
    const url = `https://api.cloudflare.com/client/v4/accounts/${accountId}/r2/buckets/${bucketName}/policy?access=PublicUrlAndCnames`;
    try {
        const { statusCode, body } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$undici$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["request"])(url, {
            method: "PUT",
            headers: {
                Authorization: `Bearer ${apiToken}`,
                "Content-Type": "application/json"
            }
        });
        const responseBody = await body.json();
        if (statusCode !== 200 || !responseBody.success) {
            throw new Error(`Failed to set public access. Status code: ${statusCode}, Error details: ${JSON.stringify(responseBody.errors)}`);
        }
        if (responseBody.result.onlyViaCnames.length > 0) {
            return responseBody.result.onlyViaCnames[0];
        } else {
            return `${responseBody.result.publicId}.r2.dev`;
        }
    } catch (error) {
        throw new Error(`Error setting public access: ${error.message}`);
    }
}
;
}),
"[project]/node_modules/next-video/dist/providers/cloudflare-r2/provider.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "uploadLocalFile",
    ()=>uploadLocalFile,
    "uploadRequestedFile",
    ()=>uploadRequestedFile
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs__$5b$external$5d$__$28$node$3a$fs$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:fs [external] (node:fs, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$stream__$5b$external$5d$__$28$node$3a$stream$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:stream [external] (node:stream, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs$2f$promises__$5b$external$5d$__$28$node$3a$fs$2f$promises$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:fs/promises [external] (node:fs/promises, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$process__$5b$external$5d$__$28$node$3a$process$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:process [external] (node:process, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$undici$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/undici/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/chalk/source/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$paralleldrive$2f$cuid2$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@paralleldrive/cuid2/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$externals$5d2f40$aws$2d$sdk$2f$client$2d$s3__$5b$external$5d$__$2840$aws$2d$sdk$2f$client$2d$s3$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/@aws-sdk/client-s3 [external] (@aws-sdk/client-s3, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/assets.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/config.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$s3$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/s3.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/provider.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/utils.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/logger.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$r2$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/r2.js [app-route] (ecmascript)");
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
const createId = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$paralleldrive$2f$cuid2$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].init({
    length: 11
});
let s3;
let bucketName;
let bucketUrlPublic;
let accountId;
let endpoint;
async function initR2() {
    const { providerConfig } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getVideoConfig"])();
    const CloudflareR2Config = providerConfig["cloudflare-r2"];
    bucketName = CloudflareR2Config?.bucket ?? "";
    bucketUrlPublic = CloudflareR2Config?.bucketUrlPublic ?? "";
    endpoint = CloudflareR2Config?.endpoint ?? "";
    accountId = endpoint.split(".")[0].replace(/^https?:\/\//, "");
    s3 ?? (s3 = new __TURBOPACK__imported__module__$5b$externals$5d2f40$aws$2d$sdk$2f$client$2d$s3__$5b$external$5d$__$2840$aws$2d$sdk$2f$client$2d$s3$2c$__cjs$29$__["S3Client"]({
        endpoint,
        // region does not have any impact on Cloudflare R2
        region: "auto",
        credentials: {
            accessKeyId: CloudflareR2Config?.accessKeyId ?? __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$process__$5b$external$5d$__$28$node$3a$process$2c$__cjs$29$__["env"].R2_ACCESS_KEY_ID ?? "",
            secretAccessKey: CloudflareR2Config?.secretAccessKey ?? __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$process__$5b$external$5d$__$28$node$3a$process$2c$__cjs$29$__["env"].R2_SECRET_ACCESS_KEY ?? ""
        }
    }));
    if (!bucketName) {
        try {
            const bucket = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$s3$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["findBucket"])(s3, (bucket2)=>bucket2.Name?.startsWith("next-videos-"));
            if (bucket) {
                bucketName = bucket.Name;
                __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Using existing Cloudflare R2 bucket:"), bucketName);
            }
        } catch (err) {
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("Error listing Cloudflare R2 buckets");
            console.error(err);
        }
    }
    if (!bucketName) {
        bucketName = `next-videos-${createId()}`;
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Creating Cloudflare R2 bucket:"), bucketName);
        try {
            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$s3$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createBucket"])(s3, bucketName, {});
            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$s3$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["putBucketCors"])(s3, bucketName);
        } catch (err) {
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("Error creating Cloudflare R2 bucket");
            console.error(err);
        }
    }
    if (!bucketUrlPublic && bucketName) {
        const cloudflareApiToken = CloudflareR2Config?.apiToken ?? __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$process__$5b$external$5d$__$28$node$3a$process$2c$__cjs$29$__["env"].R2_CF_API_TOKEN ?? "";
        let bucketPublicId;
        if (cloudflareApiToken) {
            try {
                bucketPublicId = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$r2$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["publicAccessR2Bucket"])(accountId, bucketName, cloudflareApiToken) ?? "";
                bucketUrlPublic = `https://${bucketPublicId}`;
            } catch (e) {
                __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error(`Error setting Public access for Cloudflare R2 bucket: ${bucketName}`);
                console.error(e);
                return;
            }
        }
    }
}
async function uploadLocalFile(asset) {
    const filePath = asset.originalFilePath;
    if (!filePath) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("No filePath provided for asset.");
        console.error(asset);
        return;
    }
    if ((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isRemote"])(filePath)) {
        return uploadRequestedFile(asset);
    }
    if (asset.status === "ready") {
        return;
    } else if (asset.status === "uploading") {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Resuming upload:"), filePath);
    }
    await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["updateAsset"])(filePath, {
        status: "uploading"
    });
    await initR2();
    if (!bucketUrlPublic) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error(`Public access configuration missing:
      Neither the Cloudflare API Key nor the bucketUrlPublic URL is specified for the bucket "${bucketName}".
   
      To enable public access, you must ensure one of the following:
      1. **Configure the Bucket for Public Access:**
         - Make sure the bucket "${bucketName}" is configured for public access
           and specify the public URL in the provider configuration under the key 'bucketUrlPublic'.
         - For detailed instructions, refer to the Cloudflare documentation: 
           https://developers.cloudflare.com/r2/buckets/public-buckets/
   
      2. **Provide a Cloudflare API Key:**
         - You can specify a Cloudflare API Key with R2 Admin read & write permissions using the environment variable: R2_CF_API_TOKEN.
         - This API Key will allow us to enable public access for the bucket and retrieve the public URL using the Cloudflare API.
         - To create an API Token, visit:
           https://dash.cloudflare.com/?to=/:account/r2/api-tokens`);
        return;
    }
    const fileStats = await __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs$2f$promises__$5b$external$5d$__$28$node$3a$fs$2f$promises$2c$__cjs$29$__["default"].stat(filePath);
    const stream = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs__$5b$external$5d$__$28$node$3a$fs$2c$__cjs$29$__["createReadStream"])(filePath);
    return putAsset(filePath, fileStats.size, stream);
}
async function uploadRequestedFile(asset) {
    const filePath = asset.originalFilePath;
    if (!filePath) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("No URL provided for asset.");
        console.error(asset);
        return;
    }
    if (asset.status === "ready") {
        return;
    }
    await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["updateAsset"])(filePath, {
        status: "uploading"
    });
    await initR2();
    const response = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$undici$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["fetch"])(filePath);
    const size = Number(response.headers.get("content-length"));
    const stream = response.body;
    if (!stream) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("Error fetching the requested file:", filePath);
        return;
    }
    return putAsset(filePath, size, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$stream__$5b$external$5d$__$28$node$3a$stream$2c$__cjs$29$__["Readable"].fromWeb(stream));
}
async function putAsset(filePath, size, stream) {
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].info(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("Uploading file:"), `${filePath} (${size} bytes)`);
    let key;
    try {
        key = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createAssetKey"])(filePath, "cloudflare-r2");
        await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$s3$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["putObject"])(s3, {
            ACL: "public-read",
            Bucket: bucketName,
            Key: key,
            Body: stream,
            ContentLength: size
        });
        if (stream instanceof __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs__$5b$external$5d$__$28$node$3a$fs$2c$__cjs$29$__["ReadStream"]) {
            stream.close();
        }
    } catch (e) {
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("Error uploading to Cloudflare R2");
        console.error(e);
        return;
    }
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].success(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("File uploaded:"), `${filePath} (${size} bytes)`);
    const updatedAsset = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["updateAsset"])(filePath, {
        status: "ready",
        providerMetadata: {
            "cloudflare-r2": {
                endpoint,
                bucketUrlPublic,
                bucket: bucketName,
                key
            }
        }
    });
    const url = updatedAsset.sources?.[0].src;
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].space(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$chalk$2f$source$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].gray(">"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label("URL:"), url);
    return updatedAsset;
}
;
}),
"[project]/node_modules/next-video/dist/providers/providers.js [app-route] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$mux$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/mux/provider.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$vercel$2d$blob$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/vercel-blob/provider.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$backblaze$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/backblaze/provider.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$amazon$2d$s3$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/amazon-s3/provider.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$cloudflare$2d$r2$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/cloudflare-r2/provider.js [app-route] (ecmascript)");
;
;
;
;
;
;
}),
"[project]/node_modules/next-video/dist/providers/providers.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "amazonS3",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$amazon$2d$s3$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__,
    "backblaze",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$backblaze$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__,
    "cloudflareR2",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$cloudflare$2d$r2$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__,
    "mux",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$mux$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__,
    "vercelBlob",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$vercel$2d$blob$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$providers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/providers.js [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$mux$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/mux/provider.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$vercel$2d$blob$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/vercel-blob/provider.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$backblaze$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/backblaze/provider.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$amazon$2d$s3$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/amazon-s3/provider.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$cloudflare$2d$r2$2f$provider$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/cloudflare-r2/provider.js [app-route] (ecmascript)");
}),
"[project]/node_modules/next-video/dist/handlers/local-upload.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "uploadLocalFile",
    ()=>uploadLocalFile
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$providers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/providers.js [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$providers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/providers.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/utils.js [app-route] (ecmascript)");
;
;
async function uploadLocalFile(asset, config) {
    for (let [key, provider] of Object.entries(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$providers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__)){
        if (key === (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["camelCase"])(config.provider)) {
            return provider.uploadLocalFile(asset);
        }
    }
}
;
}),
"[project]/node_modules/next-video/dist/handlers/api-request.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "uploadRequestedFile",
    ()=>uploadRequestedFile
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$providers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/providers.js [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$providers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/providers/providers.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/utils.js [app-route] (ecmascript)");
;
;
async function uploadRequestedFile(asset, config) {
    for (let [key, provider] of Object.entries(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$providers$2f$providers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__)){
        if (key === (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["camelCase"])(config.provider)) {
            return provider.uploadRequestedFile(asset);
        }
    }
}
;
}),
"[project]/node_modules/next-video/dist/with-next-video.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "withNextVideo",
    ()=>withNextVideo
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$symlink$2d$dir$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/symlink-dir/dist/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$path__$5b$external$5d$__$28$node$3a$path$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:path [external] (node:path, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs__$5b$external$5d$__$28$node$3a$fs$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:fs [external] (node:fs, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$process__$5b$external$5d$__$28$node$3a$process$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:process [external] (node:process, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$url__$5b$external$5d$__$28$node$3a$url$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:url [external] (node:url, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/logger.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/utils.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/config.js [app-route] (ecmascript)");
const __TURBOPACK__import$2e$meta__ = {
    get url () {
        return `file://${__turbopack_context__.P("node_modules/next-video/dist/with-next-video.js")}`;
    }
};
;
;
;
;
;
;
;
;
let hasWarned = false;
function withNextVideo(nextConfig, videoConfig) {
    const videoConfigComplete = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["setVideoConfig"])(videoConfig);
    const { path, folder, provider } = videoConfigComplete;
    __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$process__$5b$external$5d$__$28$node$3a$process$2c$__cjs$29$__["env"]["NEXT_PUBLIC_VIDEO_OPTS"] = JSON.stringify({
        path,
        folder,
        provider
    });
    if (process.argv[2] === "dev") {
        __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$process__$5b$external$5d$__$28$node$3a$process$2c$__cjs$29$__["env"]["NEXT_PUBLIC_DEV_VIDEO_OPTS"] = JSON.stringify({
            path,
            folder,
            provider
        });
    }
    if (typeof nextConfig === "function") {
        return async (...args)=>{
            const nextConfigResult = await nextConfig(...args);
            return withNextVideo(nextConfigResult, videoConfig);
        };
    }
    if (process.argv[2] === "dev") {
        const VIDEOS_PATH = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$path__$5b$external$5d$__$28$node$3a$path$2c$__cjs$29$__["join"])(process.cwd(), folder);
        const TMP_PUBLIC_VIDEOS_PATH = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$path__$5b$external$5d$__$28$node$3a$path$2c$__cjs$29$__["join"])(process.cwd(), "public", `_next-video`);
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$symlink$2d$dir$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"])(VIDEOS_PATH, TMP_PUBLIC_VIDEOS_PATH);
        process.on("exit", async ()=>{
            __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$fs__$5b$external$5d$__$28$node$3a$fs$2c$__cjs$29$__["default"].unlinkSync(TMP_PUBLIC_VIDEOS_PATH);
        });
    }
    const nextVersion = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getPackageVersion"])("next");
    const majorVersion = nextVersion ? parseInt(nextVersion.split(".")[0], 10) : void 0;
    if (majorVersion && majorVersion >= 15) {
        nextConfig.outputFileTracingIncludes = {
            ...nextConfig.outputFileTracingIncludes,
            [path]: [
                `./${folder}/**/*.json`
            ]
        };
    } else {
        const experimental = {
            ...nextConfig.experimental
        };
        experimental.outputFileTracingIncludes = {
            ...experimental.outputFileTracingIncludes,
            [path]: [
                `./${folder}/**/*.json`
            ]
        };
        nextConfig.experimental = experimental;
    }
    nextConfig.turbopack = {
        ...nextConfig.turbopack,
        rules: {
            ...nextConfig.turbopack?.rules,
            "*.mp4": {
                loaders: [
                    "next-video/webpack/video-raw-loader.js"
                ],
                as: "*.json"
            },
            "*.json": {
                loaders: [
                    "next-video/webpack/video-json-loader.js"
                ],
                as: "*.json"
            }
        }
    };
    const nextVideoVersion = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$utils$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getPackageVersion"])("next-video");
    if (!hasWarned && ("TURBOPACK compile-time value", true) && !process.env.NEXT_VIDEO_SUPPRESS_TURBOPACK_WARNING && nextVersion && isVersionLessThan(nextVersion, "15.5.0")) {
        hasWarned = true;
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].space(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].label(`\u25B6\uFE0E next-video ${nextVideoVersion}
`));
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].warning(`You are using next-video with \`next ${("TURBOPACK compile-time truthy", 1) ? "dev" : "TURBOPACK unreachable"} --turbo\`. next-video doesn't support Turbopack on Next.js 15.5.0 and below.
  We recommend removing the \`--turbo\` flag for use with next-video.
`);
    }
    return Object.assign({}, nextConfig, {
        webpack (config, options) {
            if (!options.defaultLoaders) {
                throw new Error("This plugin is not compatible with Next.js versions below 5.0.0 https://err.sh/next-plugins/upgrade");
            }
            config.infrastructureLogging = {
                ...config.infrastructureLogging,
                // Silence warning about dynamic import of next.config file.
                // > [webpack.cache.PackFileCacheStrategy/webpack.FileSystemInfo] Parsing of /next-video/dist/config.js for build dependencies failed at 'import(fileUrl.
                // > Build dependencies behind this expression are ignored and might cause incorrect cache invalidation.
                level: "error"
            };
            config.experiments.buildHttp = {
                allowedUris: [
                    /https?:\/\/.*\.(mp4|webm|mkv|ogg|ogv|wmv|avi|mov|flv|m4v|3gp)\??(?:&?[^=&]*=[^=&]*)*$/,
                    ...config.experiments.buildHttp?.allowedUris ?? []
                ],
                ...config.experiments.buildHttp || {},
                // Disable cache to prevent Webpack from downloading the remote sources.
                cacheLocation: false
            };
            const scriptDir = typeof ("TURBOPACK compile-time value", "/ROOT/node_modules/next-video/dist") === "string" ? ("TURBOPACK compile-time value", "/ROOT/node_modules/next-video/dist") : (0, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$path__$5b$external$5d$__$28$node$3a$path$2c$__cjs$29$__["dirname"])((0, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$url__$5b$external$5d$__$28$node$3a$url$2c$__cjs$29$__["fileURLToPath"])(__TURBOPACK__import$2e$meta__.url));
            config.module.rules.push({
                test: /\.(mp4|webm|mkv|ogg|ogv|wmv|avi|mov|flv|m4v|3gp)\??(?:&?[^=&]*=[^=&]*)*$/,
                use: [
                    {
                        loader: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$path__$5b$external$5d$__$28$node$3a$path$2c$__cjs$29$__["join"])(scriptDir, "webpack/video-json-loader.js")
                    },
                    {
                        loader: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$path__$5b$external$5d$__$28$node$3a$path$2c$__cjs$29$__["join"])(scriptDir, "webpack/video-raw-loader.js")
                    }
                ],
                type: "json"
            }, {
                test: /\.(mp4|webm|mkv|ogg|ogv|wmv|avi|mov|flv|m4v|3gp)\.json\??(?:&?[^=&]*=[^=&]*)*$/,
                use: [
                    {
                        loader: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$path__$5b$external$5d$__$28$node$3a$path$2c$__cjs$29$__["join"])(scriptDir, "webpack/video-json-loader.js")
                    }
                ],
                type: "json"
            });
            if (typeof nextConfig.webpack === "function") {
                return nextConfig.webpack(config, options);
            }
            return config;
        }
    });
}
const isVersionLessThan = (version, target)=>{
    const parseVersion = (v)=>v.split(".").map((n)=>parseInt(n, 10));
    const versionParts = parseVersion(version);
    const targetParts = parseVersion(target);
    for(let i = 0; i < Math.max(versionParts.length, targetParts.length); i++){
        const vPart = versionParts[i] || 0;
        const tPart = targetParts[i] || 0;
        if (vPart < tPart) return true;
        if (vPart > tPart) return false;
    }
    return false;
};
;
}),
"[project]/node_modules/next-video/dist/setup-next-video.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "NextVideo",
    ()=>NextVideo
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/config.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$request$2d$handler$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/request-handler.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$with$2d$next$2d$video$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/with-next-video.js [app-route] (ecmascript)");
;
;
;
function NextVideo(config) {
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["setVideoConfig"])(config);
    const withNextVideo = (nextConfig)=>{
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$with$2d$next$2d$video$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["withNextVideo"])(nextConfig, config);
    };
    return {
        GET: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$request$2d$handler$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["GET"],
        POST: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$request$2d$handler$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["POST"],
        handler: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$request$2d$handler$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"],
        withNextVideo
    };
}
;
}),
"[project]/node_modules/next-video/dist/process.js [app-route] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$video$2d$handler$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/video-handler.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$handlers$2f$local$2d$upload$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/handlers/local-upload.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$handlers$2f$api$2d$request$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/handlers/api-request.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/utils/logger.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$setup$2d$next$2d$video$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/setup-next-video.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$with$2d$next$2d$video$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/with-next-video.js [app-route] (ecmascript)");
;
;
;
;
;
;
try {
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$video$2d$handler$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["videoHandler"])("local.video.added", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$handlers$2f$local$2d$upload$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["uploadLocalFile"]);
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$video$2d$handler$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["videoHandler"])("request.video.added", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$handlers$2f$api$2d$request$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["uploadRequestedFile"]);
} catch (err) {
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$utils$2f$logger$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].error("An exception occurred within next-video. You may need to restart your dev server.");
    console.error(err);
}
;
}),
"[project]/node_modules/next-video/dist/request-handler.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "GET",
    ()=>GET,
    "POST",
    ()=>POST,
    "default",
    ()=>handler
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$process$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/process.js [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$video$2d$handler$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/video-handler.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/assets.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-video/dist/config.js [app-route] (ecmascript)");
;
;
;
async function GET(request) {
    const { searchParams } = new URL(request.url);
    const url = searchParams.get("url");
    const { status, data } = await getRequest(url);
    return Response.json(data, {
        status
    });
}
async function POST(request) {
    const { url } = await request.json();
    const { status, data } = await postRequest(url);
    return Response.json(data, {
        status
    });
}
async function handler(req, res) {
    if (req.method === "POST") {
        const { status: status2, data: data2 } = await postRequest(String(req.body.url));
        res.status(status2).json(data2);
        return;
    }
    const { status, data } = await getRequest(String(req.query.url));
    res.status(status).json(data);
}
async function getRequest(url) {
    if (!url) {
        return {
            status: 400,
            data: {
                error: "url parameter is required"
            }
        };
    }
    let asset;
    try {
        asset = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getAsset"])(url);
    } catch  {
        const isDevMode = true;
        if ("TURBOPACK compile-time truthy", 1) {
            asset = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createAsset"])(url);
            if (asset) {
                const videoConfig = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getVideoConfig"])();
                await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$video$2d$handler$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["callHandler"])("request.video.added", asset, videoConfig);
                return {
                    status: 200,
                    data: asset
                };
            } else {
                return {
                    status: 500,
                    data: {
                        error: "could not create asset"
                    }
                };
            }
        }
        //TURBOPACK unreachable
        ;
    }
    return {
        status: 200,
        data: asset
    };
}
async function postRequest(url) {
    if (!url) {
        return {
            status: 400,
            data: {
                error: "url parameter is required"
            }
        };
    }
    let asset;
    try {
        asset = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$assets$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createAsset"])(url);
        if (!asset) {
            return {
                status: 500,
                data: {
                    error: "could not create asset"
                }
            };
        }
        const videoConfig = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$config$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getVideoConfig"])();
        await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$video$2f$dist$2f$video$2d$handler$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["callHandler"])("request.video.added", asset, videoConfig);
        return {
            status: 200,
            data: asset
        };
    } catch  {
        return {
            status: 500,
            data: {
                error: "could not create asset"
            }
        };
    }
}
;
}),
];

//# sourceMappingURL=node_modules_next-video_dist_6d3ca2ec._.js.map